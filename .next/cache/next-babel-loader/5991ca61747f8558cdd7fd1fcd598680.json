{"ast":null,"code":"import _Avatar from \"antd/lib/avatar\";\nimport _message from \"antd/lib/message\";\nvar __jsx = React.createElement;\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nimport React, { Component, useEffect } from \"react\";\nimport { STYLE_URL } from \"../consts\";\nimport Marker from \"./Marker\";\nimport { connect } from \"react-redux\";\nimport BottomInfoLocation from \"./BottomInfoLocation\";\nimport MenuRightClick from \"./MenuRightCLick\";\nimport { getDetailLatLngService } from \"../redux/sagas/placeSaga\";\nimport equal from \"fast-deep-equal/es6/react\";\nimport { setMapViewportAction, getDetailByLatLngAction, setCenterLatLngAction, setMyLocationAction, getDetailByIdAction } from \"../redux/actions/place\";\nimport { searchAroundAction, clearSearchAroundAction, selectAroundPlaceAction } from \"../redux/actions/search\";\nimport { selectResultAction, navigationFromAction, navigationToAction, clearResultAction, navigationAction } from \"../redux/actions/navigation\";\nimport MarkerNavigation from \"./MarkerNavigation\";\nimport { setRedMarkerAction, setCollapsedInfoBoxAction, setPopupRightClick, setBoxVisibleAction } from \"../redux/actions/boxVisble\";\nimport normal_map_img from \"../static/images/normal_map.png\";\nimport satellite_img from \"../static/images/satellite.jpeg\";\nimport ReactDOMServer from \"react-dom/server\";\nimport Axios from \"axios\";\nimport Div100vh from \"react-div-100vh\";\nimport Request from \"../utils/request\";\nimport { Mile_Travel } from \"../consts\";\nimport { isMobile } from \"react-device-detect\";\nimport images from \"../utils/images\";\n// import { STYLE_KEY } from \"../config.dev\";\n\nclass Map extends Component {\n  constructor(props) {\n    super(props);\n    _defineProperty(this, \"_onViewportChange\", viewport => {\n      this.props.dispatch(setMapViewportAction(viewport));\n    });\n    _defineProperty(this, \"_onMouseClick\", e => {\n      this.props.dispatch(setPopupRightClick(false));\n      if (this.props.boxVisible !== \"iframe\") {\n        this.props.dispatch(setRedMarkerAction(false));\n      }\n      // if (this.props.boxVisible === \"info\") this.props.dispatch(setBoxVisibleAction('search'))\n      // this.markerWhatIs ? this.markerWhatIs.remove() : null;\n      this.props.dispatch(selectAroundPlaceAction(null));\n      this.removeMarkerWhatIs();\n      this.setState({\n        bottomInfoVisible: false\n      });\n    });\n    _defineProperty(this, \"_onRightClick\", e => {\n      const position = {\n        lat: e.lngLat.lat,\n        lng: e.lngLat.lng\n      };\n      if (this.props.boxVisible !== \"iframe\") {\n        this.props.dispatch(setRedMarkerAction(true, position));\n        this.props.dispatch(setPopupRightClick(true, position, \"normal\"));\n      }\n    });\n    _defineProperty(this, \"_onClickMenu\", evt => {\n      const parent = evt.target.parentElement;\n      if (evt.target.className && evt.target.className.toString().includes(\"what-is-this\")) {\n        this.handleWhatIs();\n      } else if (evt.target.className && evt.target.className.toString().includes(\"from-here\")) {\n        this.handleFromHere();\n      } else if (evt.target.className && evt.target.className.toString().includes(\"to-here\")) {\n        this.handleToHere();\n      } else if (evt.target.className && evt.target.className.toString().includes(\"delete-location\")) {\n        this.handleDeleteLocation();\n      } else if (evt.target.className && evt.target.className.toString().includes(\"search-around\")) {\n        this.handleSearchAround();\n      } else if (evt.target.className && evt.target.className.toString().includes(\"to-around-place\")) {\n        this.handleToAroundPlace();\n      } else if (evt.target.className && evt.target.className.toString().includes(\"what-is-navigation\")) {\n        this.handleWhatIs(false);\n      }\n      if (parent !== null && parent !== void 0 && parent.className && parent !== null && parent !== void 0 && parent.className.toString().includes(\"menu-right-click\")) {\n        if (evt.target.className && !evt.target.className.toString().includes(\"what-is-this\")) {\n          this.props.dispatch(clearSearchAroundAction());\n        }\n        this.props.dispatch(setPopupRightClick(false));\n        this.removeMarkerWhatIs();\n      }\n    });\n    _defineProperty(this, \"changeVisibleBottomInfo\", visible => {\n      this.setState({\n        bottomInfoVisible: visible\n      });\n    });\n    _defineProperty(this, \"_getInforPlace\", async (lat = (_this$props$position_ => (_this$props$position_ = this.props.position_popup) === null || _this$props$position_ === void 0 ? void 0 : _this$props$position_.lat)(), lng = (_this$props$position_2 => (_this$props$position_2 = this.props.position_popup) === null || _this$props$position_2 === void 0 ? void 0 : _this$props$position_2.lng)()) => {\n      const latLng = {\n        latitude: lat,\n        longitude: lng\n      };\n      try {\n        const response = await getDetailLatLngService(latLng);\n        if (response.data.results.length > 0) {\n          const place_response = response.data.results[0];\n          return _objectSpread(_objectSpread({}, place_response), {}, {\n            name: place_response.address_components[0].long_name,\n            formatted_address: this.getAddressGeocode(place_response)\n          });\n        } else {\n          _message.error(\"Không tìm thấy địa điểm !!\");\n          return null;\n        }\n      } catch (error) {\n        throw error;\n      }\n    });\n    _defineProperty(this, \"selectPlace\", async (lat = (_this$props$positionM => (_this$props$positionM = this.props.positionMarkerSelect) === null || _this$props$positionM === void 0 ? void 0 : _this$props$positionM.lat)(), lng = (_this$props$positionM2 => (_this$props$positionM2 = this.props.positionMarkerSelect) === null || _this$props$positionM2 === void 0 ? void 0 : _this$props$positionM2.lng)(), redMarkerVisible = true) => {\n      const place = await this._getInforPlace(lat, lng);\n      if (place) {\n        const viewport = {\n          longitude: lng,\n          latitude: lat,\n          zoom: 15\n        };\n        this.props.dispatch(setMapViewportAction(viewport));\n        this.setState({\n          bottomInfoVisible: true,\n          placeMouseClick: place\n        });\n        if (redMarkerVisible) {\n          if (this.markerWhatIs) {\n            this.markerWhatIs.setLngLat({\n              lat,\n              lng\n            }).addTo(this.map);\n          } else {\n            const el = document.createElement(\"div\");\n            el.innerHTML = ReactDOMServer.renderToStaticMarkup(__jsx(Marker, {\n              size: 22\n            }));\n            this.markerWhatIs = new maplibregl.Marker(el, {\n              anchor: \"bottom\"\n            }).setLngLat({\n              lat,\n              lng\n            }).addTo(this.map);\n          }\n          this.markerWhatIs.getElement().addEventListener(\"contextmenu\", e => {\n            e.stopPropagation();\n            e.preventDefault();\n            this.props.dispatch(setRedMarkerAction(false));\n            this.props.dispatch(setPopupRightClick(true, {\n              lat,\n              lng\n            }, \"popupCurrentPlace\"));\n          });\n          this.props.dispatch(setRedMarkerAction(false));\n        }\n        // redMarkerVisible ? this.props.dispatch(setRedMarkerAction(true, { lat, lng })) : null;\n      } else {\n        _message.error(\"Không tìm thấy địa điểm !!\");\n      }\n    });\n    _defineProperty(this, \"removeMarkerWhatIs\", () => {\n      this.markerWhatIs ? this.markerWhatIs.remove() : null;\n    });\n    _defineProperty(this, \"_getInforPlaceAround\", async id => {\n      try {\n        const response = await Axios.get(`https://napi.goong.io/v1/marker/get_marker_detail/${id}`);\n        if (response.data.data) {\n          return response.data.data;\n        } else {\n          _message.error(\"Không tìm thấy địa điểm !!\");\n          return null;\n        }\n      } catch (error) {\n        _message.error(\"Không tìm thấy địa điểm !\");\n        throw error;\n      }\n    });\n    _defineProperty(this, \"selectAroundPlace\", async id => {\n      const place = await this._getInforPlaceAround(id);\n      if (place) {\n        const viewport = {\n          longitude: Number(place.lng_lat[0]),\n          latitude: Number(place.lng_lat[1]),\n          zoom: 15\n        };\n        this.props.dispatch(setMapViewportAction(viewport));\n        this.setState({\n          bottomInfoVisible: true,\n          placeMouseClick: place\n        });\n        this.props.dispatch(setPopupRightClick(false));\n      } else {\n        _message.error(\"Không tìm thấy địa điểm !!\");\n      }\n    });\n    _defineProperty(this, \"handleWhatIs\", (redMarkerVisible = true) => {\n      const {\n        position_popup,\n        isSmallScreen\n      } = this.props;\n      if (isSmallScreen) {\n        this.props.dispatch(getDetailByLatLngAction({\n          latitude: position_popup.lat,\n          longitude: position_popup.lng\n        }));\n        this.props.dispatch(setBoxVisibleAction(\"info\"));\n        this.props.dispatch(clearSearchAroundAction());\n        this.props.dispatch(setPopupRightClick(false));\n        this.removeMarkerWhatIs();\n      } else {\n        this.selectPlace(position_popup.lat, position_popup.lng, redMarkerVisible);\n      }\n    });\n    _defineProperty(this, \"handleFromHere\", async (lat, lng) => {\n      let place;\n      if (!lat || !lng) place = await this._getInforPlace();else {\n        place = await this._getInforPlace(lat, lng);\n      }\n      if (place) {\n        const viewport = {\n          longitude: place.geometry.location.lng,\n          latitude: place.geometry.location.lat,\n          zoom: 15\n        };\n        !this.props.to_place && this.props.dispatch(setMapViewportAction(viewport));\n        this.props.dispatch(setBoxVisibleAction(\"navigation\"));\n        this.props.dispatch(navigationFromAction(place, `${place.name} - ${place.formatted_address}`));\n        this.props.dispatch(setRedMarkerAction(false));\n        this.changeVisibleBottomInfo(false);\n      }\n    });\n    _defineProperty(this, \"handleToHere\", async (lat, lng) => {\n      let place;\n      if (!lat || !lng) place = await this._getInforPlace();else {\n        place = await this._getInforPlace(lat, lng);\n      }\n      if (place) {\n        this.props.dispatch(setBoxVisibleAction(\"navigation\"));\n        const viewport = {\n          longitude: place.geometry.location.lng,\n          latitude: place.geometry.location.lat,\n          zoom: 15\n        };\n        const my_location = this.props.my_location;\n        if (my_location && (this.props.boxVisible === \"search\" || this.props.boxVisible === \"info\")) {\n          try {\n            const response = await Request.geocode(my_location);\n            if (response.data.results.length > 0) {\n              this.props.dispatch(navigationFromAction(_objectSpread(_objectSpread({}, response.data.results[0]), {}, {\n                name: response.data.results[0].address_components[0].long_name\n              }), \"Vị trí của bạn\"));\n            }\n          } catch (error) {\n            throw error;\n          }\n        }\n        !this.props.from_place && this.props.dispatch(setMapViewportAction(viewport));\n        this.props.dispatch(navigationToAction(place, `${place.name} - ${place.formatted_address}`));\n        this.props.dispatch(setBoxVisibleAction(\"navigation\"));\n        this.props.dispatch(setRedMarkerAction(false));\n        this.changeVisibleBottomInfo(false);\n      }\n    });\n    _defineProperty(this, \"handleDeleteLocation\", () => {\n      const {\n        type_popup\n      } = this.props;\n      if (type_popup === \"popupFromPlace\") {\n        this.props.dispatch(navigationFromAction(null, \"\"));\n      } else if (type_popup === \"popupToPlace\") {\n        this.props.dispatch(navigationToAction(null, \"\"));\n      }\n      this.props.dispatch(clearResultAction());\n    });\n    _defineProperty(this, \"handleSearchAround\", async () => {\n      const place = await this._getInforPlace();\n      if (place) {\n        const viewport = {\n          longitude: place.geometry.location.lng,\n          latitude: place.geometry.location.lat,\n          zoom: 15\n        };\n        const location = {\n          lat: place.geometry.location.lat,\n          lng: place.geometry.location.lng\n        };\n        this.props.dispatch(setBoxVisibleAction(\"search\"));\n        this.props.dispatch(setMapViewportAction(viewport));\n        this.props.dispatch(searchAroundAction(location, this.props.viewport.zoom));\n        this.setState({\n          bottomInfoVisible: false\n        });\n      }\n    });\n    _defineProperty(this, \"_selectAroundPlace\", (type, place) => {\n      if (type !== \"center\") {\n        this.props.dispatch(selectAroundPlaceAction(place));\n        this.selectAroundPlace(place === null || place === void 0 ? void 0 : place.id);\n      } else {\n        this.props.dispatch(selectAroundPlaceAction(place));\n        this.selectPlace(place.geometry.location.lat, place.geometry.location.lng, false);\n      }\n    });\n    _defineProperty(this, \"handleToAroundPlace\", async () => {\n      let place = null;\n      this.props.around_places.map(item => {\n        if (item.lng_lat[0] * 1 === this.popupRightClick.getLngLat().lng && item.lng_lat[1] * 1 === this.popupRightClick.getLngLat().lat) {\n          place = item;\n        }\n      });\n      if (place) {\n        try {\n          var _response$data;\n          this.props.dispatch(setPopupRightClick(false));\n          const place_center = this.props.around_place_center;\n          this.props.dispatch(navigationFromAction(place_center, `${place_center.name} - ${place_center.formatted_address}`));\n          const response = await Axios.get(`https://napi.goong.io/v1/marker/get_marker_detail/${place.id}`);\n          place = (_response$data = response.data) === null || _response$data === void 0 ? void 0 : _response$data.data;\n          place = _objectSpread(_objectSpread({}, place), {}, {\n            place_id: place._id,\n            geometry: {\n              location: {\n                lat: Number(place.lng_lat[1]),\n                lng: Number(place.lng_lat[0])\n              }\n            },\n            formatted_address: place.description.address\n          });\n          this.props.dispatch(navigationToAction(place, `${place.name} - ${place.formatted_address}`));\n          this.props.dispatch(setBoxVisibleAction(\"navigation\"));\n        } catch (error) {\n          _message.error(\"Không tìm thấy địa điểm !\");\n        }\n      } else {\n        _message.error(\"Không tìm thấy địa điểm !\");\n      }\n    });\n    _defineProperty(this, \"removeMarkerPopup\", () => {\n      if (this.markerCurrentPlace) this.markerCurrentPlace.remove();\n      if (this.popupRightClick) this.popupRightClick.remove();\n      if (this.props.around_places) this.props.dispatch(clearSearchAroundAction());\n      if (this.redMarker) this.redMarker.remove();\n    });\n    _defineProperty(this, \"getAddressGeocode\", place => {\n      var _place$address_compon;\n      let result = [];\n      (_place$address_compon = place.address_components) === null || _place$address_compon === void 0 ? void 0 : _place$address_compon.slice(1).map(item => {\n        result.push(item.long_name);\n      });\n      return result.join(\",\");\n    });\n    _defineProperty(this, \"changeStyle\", () => {\n      const {\n        style\n      } = this.state;\n      if (style === STYLE_URL.SATELITE + \"YJTajS80fLlhJ4a2BG0gXqXXdZzdLG5V3iivOK9e\") {\n        this.setState({\n          style: STYLE_URL.NORMAL + \"YJTajS80fLlhJ4a2BG0gXqXXdZzdLG5V3iivOK9e\"\n        });\n        this.map.setStyle(STYLE_URL.NORMAL + \"YJTajS80fLlhJ4a2BG0gXqXXdZzdLG5V3iivOK9e\");\n      } else {\n        this.setState({\n          style: STYLE_URL.SATELITE + \"YJTajS80fLlhJ4a2BG0gXqXXdZzdLG5V3iivOK9e\"\n        });\n        this.map.setStyle(STYLE_URL.SATELITE + \"YJTajS80fLlhJ4a2BG0gXqXXdZzdLG5V3iivOK9e\");\n      }\n    });\n    _defineProperty(this, \"navigationByURLIframe\", async (from, to) => {\n      this.props.dispatch(setBoxVisibleAction('iframe'));\n      this.props.dispatch(setRedMarkerAction(false));\n      this.changeVisibleBottomInfo(false);\n      let fromplace;\n      if (!from.lat || !from.lng) fromplace = await this._getInforPlace();else {\n        fromplace = await this._getInforPlace(from.lat, from.lng);\n      }\n      await this.props.dispatch(navigationFromAction(fromplace, `${fromplace.name} - ${fromplace.formatted_address}`));\n      let toplace;\n      if (!to.lat || !to.lng) toplace = await this._getInforPlace();else {\n        toplace = await this._getInforPlace(to.lat, to.lng);\n      }\n      await this.props.dispatch(navigationToAction(toplace, `${toplace.name} - ${toplace.formatted_address}`));\n      this.props.dispatch(navigationAction(this.props.from_place, this.props.to_place, 'car'));\n    });\n    _defineProperty(this, \"navigationByURL\", async (from, to) => {\n      this.props.dispatch(setBoxVisibleAction(\"navigation\"));\n      this.props.dispatch(setRedMarkerAction(false));\n      this.changeVisibleBottomInfo(false);\n      let fromplace;\n      if (!from.lat || !from.lng) fromplace = await this._getInforPlace();else {\n        fromplace = await this._getInforPlace(from.lat, from.lng);\n      }\n      await this.props.dispatch(navigationFromAction(fromplace, `${fromplace.name} - ${fromplace.formatted_address}`));\n      let toplace;\n      if (!to.lat || !to.lng) toplace = await this._getInforPlace();else {\n        toplace = await this._getInforPlace(to.lat, to.lng);\n      }\n      await this.props.dispatch(navigationToAction(toplace, `${toplace.name} - ${toplace.formatted_address}`));\n    });\n    _defineProperty(this, \"handleStorageChange\", event => {\n      console.log('oppaopaopa');\n      if (event.key === 'search_history') {\n        this.setState({\n          value: event.newValue\n        });\n      }\n    });\n    this._mapRef = /*#__PURE__*/React.createRef();\n    this.map = null;\n    this.redMarker = null;\n    this.popupRightClick = null;\n    this.popup_navigation = [];\n    this.state = {\n      style: STYLE_URL.NORMAL + \"YJTajS80fLlhJ4a2BG0gXqXXdZzdLG5V3iivOK9e\",\n      styleNormal: STYLE_URL.NORMAL + \"YJTajS80fLlhJ4a2BG0gXqXXdZzdLG5V3iivOK9e\",\n      styleEarth: STYLE_URL.SATELITE + \"YJTajS80fLlhJ4a2BG0gXqXXdZzdLG5V3iivOK9e\",\n      bottomInfoVisible: false,\n      value: localStorage.getItem('search_history') || ''\n    };\n    this.list = [];\n    this.listRestaurant = [];\n    this.listHistories = [];\n    this.view = null;\n    this.navigationView = null;\n  }\n  componentDidUpdate(prevProps) {\n    if (this.props.isSmallScreen !== prevProps.isSmallScreen) {\n      if (!this.props.isSmallScreen && !this.navigation) {\n        this.navigation = new maplibregl.NavigationControl();\n        this.map.addControl(this.navigation);\n      } else if (this.props.isSmallScreen && this.navigation) {\n        this.map.removeControl(this.navigation);\n        this.navigation = null;\n      }\n    }\n    if (!equal(prevProps.positionMarkerSelect, this.props.positionMarkerSelect) && this.props.positionMarkerSelect) {\n      if (this.redMarker) {\n        this.redMarker = this.redMarker.setLngLat(this.props.positionMarkerSelect).addTo(this.map);\n      } else {\n        const el = document.createElement(\"div\");\n        el.innerHTML = ReactDOMServer.renderToStaticMarkup(__jsx(Marker, {\n          size: 22\n        }));\n        // Marker chuột phải\n        this.redMarker = new maplibregl.Marker({\n          anchor: \"bottom\",\n          element: el\n        }).setLngLat(this.props.positionMarkerSelect).addTo(this.map);\n        this.redMarker.getElement().addEventListener(\"contextmenu\", e => {\n          e.stopPropagation();\n          e.preventDefault();\n          this.props.dispatch(setPopupRightClick(true, this.props.positionMarkerSelect, \"normal\"));\n        });\n      }\n    }\n    if (prevProps.markerSelect !== this.props.markerSelect) {\n      if (!this.props.markerSelect) {\n        var _this$redMarker;\n        (_this$redMarker = this.redMarker) === null || _this$redMarker === void 0 ? void 0 : _this$redMarker.remove();\n      }\n    }\n    if (this.props.popup_visible && (!equal(prevProps.position_popup, this.props.position_popup) || this.props.type_popup !== prevProps.type_popup) && this.props.position_popup) {\n      this.popupRightClick = this.popupRightClick ? this.popupRightClick.setLngLat([this.props.position_popup.lng, this.props.position_popup.lat]).addTo(this.map).setHTML(ReactDOMServer.renderToStaticMarkup(__jsx(MenuRightClick, {\n        dispatch: this.props.dispatch,\n        position_popup: this.props.position_popup,\n        type_popup: this.props.type_popup\n      }))) : new maplibregl.Popup({\n        closeButton: false,\n        anchor: \"top\",\n        closeOnClick: false,\n        offset: [0, 5]\n      }).setLngLat([this.props.position_popup.lng, this.props.position_popup.lat]).setHTML(ReactDOMServer.renderToStaticMarkup(__jsx(MenuRightClick, {\n        dispatch: this.props.dispatch,\n        position_popup: this.props.position_popup,\n        type_popup: this.props.type_popup\n      }))).addTo(this.map);\n    }\n    if (this.popupRightClick && !this.props.popup_visible) {\n      this.popupRightClick.remove();\n    }\n    if (!equal(prevProps.current_place, this.props.current_place) && this.props.current_place) {\n      const selectedPlace = this.props.current_place;\n      this.map.flyTo({\n        center: [selectedPlace.geometry.location.lng, selectedPlace.geometry.location.lat],\n        zoom: 15,\n        speed: 1.5,\n        curve: 1\n      });\n      this.props.dispatch(setCollapsedInfoBoxAction(false));\n      this.props.dispatch(setRedMarkerAction(false));\n      this.setState({\n        bottomInfoVisible: false\n      });\n    }\n    if (!equal(prevProps.viewport, this.props.viewport) && this.props.viewport) {\n      this.map.flyTo({\n        center: [this.props.viewport.longitude, this.props.viewport.latitude],\n        zoom: this.props.viewport.zoom,\n        speed: 2\n      });\n    }\n    if (!equal(prevProps.around_place_center, this.props.around_place_center)) {\n      this.props.dispatch(setRedMarkerAction(false));\n    }\n    if (!equal(prevProps.boxVisible, this.props.boxVisible) && this.props.boxVisible === \"navigation\") {\n      this.removeMarkerPopup();\n    }\n    if (!equal(prevProps.result_select, this.props.result_select) || !equal(prevProps.result_navigation, this.props.result_navigation)) {\n      const {\n        result_select,\n        result_navigation,\n        boxVisible,\n        from_place,\n        to_place\n      } = this.props;\n      let dashedLineGeoJSON = [],\n        polylineGeoJSON = [];\n      this.result_navigation = [];\n      if (boxVisible !== \"navigation\" && boxVisible !== \"iframe\" || !result_navigation) {\n        var _this$popup_navigatio, _this$popup_navigatio2;\n        // Remove cac layer/source\n        if (this.map.getLayer(`route-layer-fastest`)) this.map.removeLayer(`route-layer-fastest`);\n        if (this.map.getLayer(`route-layer-shortest`)) this.map.removeLayer(`route-layer-shortest`);\n        if (this.map.getLayer(`walk-layer-0`)) this.map.removeLayer(`walk-layer-0`);\n        if (this.map.getLayer(`walk-layer-1`)) this.map.removeLayer(`walk-layer-1`);\n        if (this.map.getSource(`route-source-fastest`)) this.map.removeSource(`route-source-fastest`);\n        if (this.map.getSource(`route-source-shortest`)) this.map.removeSource(`route-source-shortest`);\n        if (this.map.getSource(`walk-source-0`)) this.map.removeSource(`walk-source-0`);\n        if (this.map.getSource(`walk-source-1`)) this.map.removeSource(`walk-source-1`);\n        (_this$popup_navigatio = this.popup_navigation[0]) === null || _this$popup_navigatio === void 0 ? void 0 : _this$popup_navigatio.remove();\n        (_this$popup_navigatio2 = this.popup_navigation[1]) === null || _this$popup_navigatio2 === void 0 ? void 0 : _this$popup_navigatio2.remove();\n      } else {\n        if (result_navigation) {\n          let distance = \"\";\n          if (localStorage.getItem(\"unit\") === \"KILOMETERS\") {\n            distance = `${(result_navigation.fastest[0].legs[0].distance.value / 1000).toFixed(1)} KM`;\n          } else if (localStorage.getItem(\"unit\") === \"MILES\") {\n            distance = `${(result_navigation.fastest[0].legs[0].distance.value / 1000 * Mile_Travel.MILES).toFixed(1)} Dặm`;\n          } else {\n            distance = `${(result_navigation.fastest[0].legs[0].distance.value / 1000).toFixed(1)} KM`;\n          }\n          let coordinateObject1 = {};\n          coordinateObject1.coordinates = this.decodePolyline(result_navigation.fastest[0].overview_polyline.points);\n          coordinateObject1.type = \"LineString\";\n          polylineGeoJSON.push(coordinateObject1);\n          polylineGeoJSON[0].roadWay = \"fastest\";\n          let coordinateObject2 = {};\n          coordinateObject2.coordinates = this.decodePolyline(result_navigation.shortest[0].overview_polyline.points);\n          coordinateObject2.type = \"LineString\";\n          polylineGeoJSON.push(coordinateObject2);\n          polylineGeoJSON[1].roadWay = \"shortest\";\n          dashedLineGeoJSON.push({\n            type: \"LineString\",\n            coordinates: [[polylineGeoJSON[0].coordinates[0][0], polylineGeoJSON[0].coordinates[0][1]], [from_place === null || from_place === void 0 ? void 0 : from_place.geometry.location.lng, from_place === null || from_place === void 0 ? void 0 : from_place.geometry.location.lat]]\n          });\n          dashedLineGeoJSON.push({\n            type: \"LineString\",\n            coordinates: [[polylineGeoJSON[0].coordinates[polylineGeoJSON[0].coordinates.length - 1][0], polylineGeoJSON[0].coordinates[polylineGeoJSON[0].coordinates.length - 1][1]], [to_place === null || to_place === void 0 ? void 0 : to_place.geometry.location.lng, to_place === null || to_place === void 0 ? void 0 : to_place.geometry.location.lat]]\n          });\n          polylineGeoJSON.map((item, i) => {\n            // Layer dan duong\n            if (this.map.getLayer(`route-layer-${item.roadWay}`)) this.map.removeLayer(`route-layer-${item.roadWay}`);\n            if (this.map.getSource(`route-source-${item.roadWay}`)) this.map.removeSource(`route-source-${item.roadWay}`);\n            this.map.addSource(`route-source-${item.roadWay}`, {\n              type: \"geojson\",\n              data: {\n                type: \"Feature\",\n                properties: {},\n                geometry: item\n              }\n            });\n            this.map.addLayer({\n              id: `route-layer-${item.roadWay}`,\n              type: \"line\",\n              source: `route-source-${item.roadWay}`,\n              layout: {\n                \"line-join\": \"round\",\n                \"line-cap\": \"round\"\n              },\n              paint: {\n                \"line-color\": \"rgb(24, 144, 255)\",\n                \"line-width\": 7,\n                \"line-opacity\": item.roadWay === result_select ? 1 : 0.5\n              }\n            });\n            // Layer di bo\n\n            if (this.map.getLayer(`walk-layer-${i}`)) this.map.removeLayer(`walk-layer-${i}`);\n            if (this.map.getSource(`walk-source-${i}`)) this.map.removeSource(`walk-source-${i}`);\n            this.map.addSource(`walk-source-${i}`, {\n              type: \"geojson\",\n              data: {\n                type: \"Feature\",\n                properties: {},\n                geometry: dashedLineGeoJSON[i]\n              }\n            });\n            this.map.addLayer({\n              id: `walk-layer-${i}`,\n              type: \"line\",\n              source: `walk-source-${i}`,\n              layout: {\n                \"line-join\": \"round\",\n                \"line-cap\": \"round\"\n              },\n              paint: {\n                \"line-color\": \"rgb(133, 135, 126)\",\n                \"line-opacity\": 1,\n                \"line-width\": 6,\n                \"line-dasharray\": [0.2, 2]\n              }\n            });\n            // Add Popup hien ket qua\n\n            if (this.popup_navigation[i]) {\n              var _this$popup_navigatio3;\n              (_this$popup_navigatio3 = this.popup_navigation[i]) === null || _this$popup_navigatio3 === void 0 ? void 0 : _this$popup_navigatio3.remove();\n              this.popup_navigation[i] = null;\n            }\n            this.popup_navigation[i] = new maplibregl.Popup({\n              closeButton: false,\n              anchor: \"top\",\n              closeOnClick: false,\n              className: item.roadWay === result_select ? \"popup-z-index1\" : \"popup-z-index2\"\n            }).setLngLat([i === 0 ? item.coordinates[Math.trunc(0.75 * item.coordinates.length)][0] : item.coordinates[Math.trunc(0.25 * item.coordinates.length)][0], i === 0 ? item.coordinates[Math.trunc(item.coordinates.length * 0.75)][1] : item.coordinates[Math.trunc(item.coordinates.length * 0.25)][1]]).setHTML(ReactDOMServer.renderToStaticMarkup(__jsx(\"div\", {\n              className: \"tooltipNavigation\",\n              id: `popup-${item.roadWay}`\n            }, __jsx(\"p\", null, distance), __jsx(\"p\", null, result_navigation[item.roadWay][0].legs[0].duration.text)))).setMaxWidth(\"300px\").addTo(this.map);\n            document.getElementById(`popup-${item.roadWay}`).addEventListener(\"click\", () => {\n              this.props.dispatch(selectResultAction(item.roadWay));\n            });\n            const normalizeBounds = bounds => {\n              const [firstPoint, secondPoint] = bounds;\n              const minLat = Math.min(firstPoint[1], secondPoint[1]);\n              const maxLat = Math.max(firstPoint[1], secondPoint[1]);\n              const minLng = Math.min(firstPoint[0], secondPoint[0]);\n              const maxLng = Math.max(firstPoint[0], secondPoint[0]);\n              return [[minLng, minLat], [maxLng, maxLat]];\n            };\n            const bound = normalizeBounds([item.coordinates[0], item.coordinates[item.coordinates.length - 1]]);\n            if (isMobile) {\n              this.navigationView = this.map.cameraForBounds(bound, {\n                padding: {\n                  top: 10,\n                  bottom: 25,\n                  left: 24,\n                  right: 24\n                }\n              });\n            } else {\n              this.navigationView = this.map.cameraForBounds(bound, {\n                padding: {\n                  top: 40,\n                  bottom: 40,\n                  left: 200,\n                  right: 40\n                }\n              });\n            }\n          });\n          this.view = {\n            latitude: this.navigationView.center.lat,\n            longitude: this.navigationView.center.lng,\n            zoom: this.navigationView.zoom\n          };\n        }\n      }\n      this.props.dispatch(setMapViewportAction(this.view));\n    }\n    if (!equal(prevProps.from_place, this.props.from_place)) {\n      const place = this.props.from_place;\n      if (place) {\n        const popup = new maplibregl.Popup({\n          offset: [0, -18],\n          className: \"tooltip-marker\",\n          closeButton: false\n        }).setHTML(`<div class=\"ant-tooltip-inner tooltip-info-location\">${place.name}</div>`).setMaxWidth(\"150px\");\n        if (this.start_marker) {\n          this.start_marker = this.start_marker.setLngLat(place.geometry.location).setPopup(popup).addTo(this.map);\n        } else {\n          const marker_start = document.createElement(\"div\");\n          marker_start.innerHTML = ReactDOMServer.renderToStaticMarkup(__jsx(\"div\", {\n            className: \"marker-start\"\n          }, __jsx(\"img\", {\n            src: images.button,\n            style: {\n              width: 12\n            },\n            alt: \"\"\n          })));\n          this.start_marker = new maplibregl.Marker({\n            anchor: \"center\",\n            element: marker_start\n          }).setPopup(popup).setLngLat(place.geometry.location).addTo(this.map);\n          this.start_marker.getElement().addEventListener(\"contextmenu\", e => {\n            e.stopPropagation();\n            e.preventDefault();\n            const lngLat = this.start_marker.getLngLat();\n            this.props.dispatch(setPopupRightClick(true, lngLat, \"popupFromPlace\"));\n            this.props.dispatch(setRedMarkerAction(false));\n          });\n          this.start_marker.getElement().addEventListener(\"click\", () => {\n            if (popup.isOpen()) {\n              this.start_marker.togglePopup();\n            }\n          });\n          this.start_marker.getElement().addEventListener(\"mouseenter\", () => this.start_marker.togglePopup());\n          this.start_marker.getElement().addEventListener(\"mouseleave\", () => this.start_marker.togglePopup());\n        }\n      } else {\n        var _prevProps$from_place, _this$state$placeMous;\n        if (equal(this.start_marker.getLngLat(), this.props.position_popup)) {\n          this.props.dispatch(setPopupRightClick(false));\n        }\n        if (equal((_prevProps$from_place = prevProps.from_place) === null || _prevProps$from_place === void 0 ? void 0 : _prevProps$from_place.place_id, (_this$state$placeMous = this.state.placeMouseClick) === null || _this$state$placeMous === void 0 ? void 0 : _this$state$placeMous.place_id)) {\n          this.changeVisibleBottomInfo(false);\n        }\n        this.changeVisibleBottomInfo(false);\n        this.start_marker ? this.start_marker.remove() : null;\n      }\n    }\n    if (!equal(prevProps.to_place, this.props.to_place)) {\n      const place = this.props.to_place;\n      if (place) {\n        const popup = new maplibregl.Popup({\n          offset: [0, -18],\n          className: \"tooltip-marker\",\n          closeButton: false\n        }).setHTML(`<div class=\"ant-tooltip-inner tooltip-info-location\">${place.name}</div>`).setMaxWidth(\"150px\");\n        if (this.end_marker) {\n          this.to_place = this.end_marker.setPopup(popup).setLngLat(place.geometry.location).addTo(this.map);\n        } else {\n          const marker_end = document.createElement(\"div\");\n          marker_end.innerHTML = ReactDOMServer.renderToStaticMarkup(__jsx(\"div\", {\n            className: \"marker-end\"\n          }, __jsx(\"div\", null, __jsx(\"img\", {\n            src: images.marker,\n            alt: \"\"\n          }))));\n          this.end_marker = new maplibregl.Marker({\n            anchor: \"center\",\n            element: marker_end\n          }).setPopup(popup).setLngLat(place.geometry.location).addTo(this.map);\n          this.end_marker.getElement().addEventListener(\"contextmenu\", e => {\n            e.stopPropagation();\n            e.preventDefault();\n            const lngLat = this.end_marker.getLngLat();\n            this.props.dispatch(setPopupRightClick(true, lngLat, \"popupToPlace\"));\n            this.props.dispatch(setRedMarkerAction(false));\n          });\n          this.end_marker.getElement().addEventListener(\"click\", () => {\n            if (popup.isOpen()) {\n              this.end_marker.togglePopup();\n            }\n          });\n          this.end_marker.getElement().addEventListener(\"mouseenter\", () => this.end_marker.togglePopup());\n          this.end_marker.getElement().addEventListener(\"mouseleave\", () => this.end_marker.togglePopup());\n        }\n      } else {\n        var _this$start_marker, _prevProps$to_place, _this$state$placeMous2;\n        if (equal((_this$start_marker = this.start_marker) === null || _this$start_marker === void 0 ? void 0 : _this$start_marker.getLngLat(), this.props.position_popup)) {\n          this.props.dispatch(setPopupRightClick(false));\n        }\n        if (equal((_prevProps$to_place = prevProps.to_place) === null || _prevProps$to_place === void 0 ? void 0 : _prevProps$to_place.place_id, (_this$state$placeMous2 = this.state.placeMouseClick) === null || _this$state$placeMous2 === void 0 ? void 0 : _this$state$placeMous2.place_id)) {\n          this.changeVisibleBottomInfo(false);\n        }\n        this.end_marker ? this.end_marker.remove() : null;\n      }\n    }\n    if (!equal(prevProps.around_places, this.props.around_places) || !equal(prevProps.around_place_select, this.props.around_place_select)) {\n      var _this$list_marker_aro;\n      if (((_this$list_marker_aro = this.list_marker_around) === null || _this$list_marker_aro === void 0 ? void 0 : _this$list_marker_aro.length) > 0) {\n        this.list_marker_around.forEach(item => {\n          item.remove();\n        });\n        this.list_marker_around = [];\n      }\n      const {\n        around_places,\n        around_place_center\n      } = this.props;\n      if (around_places.length > 0) {\n        this.list_marker_around = [];\n        let el = document.createElement(\"div\");\n        el.innerHTML = ReactDOMServer.renderToStaticMarkup(__jsx(Marker, {\n          id: \"marker-center\",\n          type: \"center\"\n        }));\n        this.list_marker_around[0] = new maplibregl.Marker(el, {\n          anchor: \"bottom\"\n        }).setPopup(new maplibregl.Popup({\n          offset: [0, -32],\n          className: \"tooltip-marker\",\n          closeButton: false\n        }).setHTML(`<div class=\"ant-tooltip-inner tooltip-info-location\">${around_place_center.name}</div>`).setMaxWidth(\"150px\")).setLngLat(around_place_center.geometry.location).addTo(this.map);\n        const markerCenterDiv = this.list_marker_around[0].getElement();\n        markerCenterDiv.addEventListener(\"click\", () => {\n          this._selectAroundPlace(\"center\", around_place_center);\n          this.props.dispatch(setRedMarkerAction(false));\n          if (this.list_marker_around[0].getPopup().isOpen()) {\n            this.list_marker_around[0].togglePopup();\n          }\n        });\n        markerCenterDiv.addEventListener(\"contextmenu\", e => {\n          e.stopPropagation();\n          e.preventDefault();\n          this.props.dispatch(setRedMarkerAction(false));\n          this.props.dispatch(setPopupRightClick(true, around_place_center.geometry.location, \"normal\"));\n        });\n        markerCenterDiv.addEventListener(\"mouseenter\", () => this.list_marker_around[0].togglePopup());\n        markerCenterDiv.addEventListener(\"mouseleave\", () => this.list_marker_around[0].togglePopup());\n        around_places.forEach((item, i) => {\n          const popup = new maplibregl.Popup({\n            offset: [0, -32],\n            className: \"tooltip-marker\",\n            closeButton: false,\n            anchor: \"bottom\"\n          }).setHTML(`<div class=\"ant-tooltip-inner tooltip-info-location\">${item.name}</div>`).setMaxWidth(\"150px\");\n          el = document.createElement(\"div\");\n          el.innerHTML = ReactDOMServer.renderToStaticMarkup(__jsx(Marker, {\n            type: \"around\",\n            place: item,\n            place_select: this.props.around_place_select,\n            id: `marker-around-${i}`\n          }));\n          this.list_marker_around.push(new maplibregl.Marker(el, {\n            anchor: \"bottom\"\n          }).setPopup(popup).setLngLat([item.lng_lat[0] * 1, item.lng_lat[1] * 1]).addTo(this.map));\n          const markerDiv = this.list_marker_around[i + 1].getElement();\n          markerDiv.addEventListener(\"click\", e => {\n            e.stopPropagation();\n            this.props.dispatch(setRedMarkerAction(false));\n            this._selectAroundPlace(\"around\", item);\n            if (popup.isOpen()) {\n              this.list_marker_around[i + 1].togglePopup();\n            }\n          });\n          markerDiv.addEventListener(\"contextmenu\", e => {\n            e.stopPropagation();\n            e.preventDefault();\n            this.props.dispatch(setPopupRightClick(true, {\n              lng: item.lng_lat[0] * 1,\n              lat: item.lng_lat[1] * 1\n            }, \"around\"));\n            this.props.dispatch(setRedMarkerAction(false));\n          });\n          markerDiv.addEventListener(\"mouseenter\", () => this.list_marker_around[i + 1].togglePopup());\n          markerDiv.addEventListener(\"mouseleave\", () => this.list_marker_around[i + 1].togglePopup());\n        });\n      }\n    }\n    if (this.props.boxVisible === \"info\" && this.props.current_place) {\n      if (!this.markerCurrentPlace) {\n        var _this$props$current_p, _this$props$current_p2;\n        const el = document.createElement(\"div\");\n        el.innerHTML = ReactDOMServer.renderToStaticMarkup(\n        // <Marker type=\"normal\" />\n        __jsx(\"div\", {\n          className: \"marker-histories\"\n        }, __jsx(\"div\", null, __jsx(\"img\", {\n          src: images.marker,\n          alt: \"\"\n        }))));\n        // Marker info\n        this.markerCurrentPlace = new maplibregl.Marker({\n          anchor: \"bottom\",\n          element: el\n        }).setLngLat((_this$props$current_p = this.props.current_place) === null || _this$props$current_p === void 0 ? void 0 : (_this$props$current_p2 = _this$props$current_p.geometry) === null || _this$props$current_p2 === void 0 ? void 0 : _this$props$current_p2.location).addTo(this.map);\n        this.markerCurrentPlace.getElement().addEventListener(\"contextmenu\", e => {\n          e.stopPropagation();\n          e.preventDefault();\n          const lngLat = this.markerCurrentPlace.getLngLat();\n          this.props.dispatch(setPopupRightClick(true, lngLat, \"popupCurrentPlace\"));\n        });\n      } else {\n        this.markerCurrentPlace.setLngLat(this.props.current_place.geometry.location).addTo(this.map);\n      }\n    }\n    if (this.props.boxVisible !== \"info\" && this.markerCurrentPlace) {\n      this.markerCurrentPlace.remove();\n      this.markerCurrentPlace = null;\n    }\n    if (this.props.boxVisible === \"detailsrestaurant\" && this.props.restaurantData) {\n      if (this.props.restaurantData.length !== 0) {\n        for (let item of this.props.restaurantData) {\n          const marker_restaurant = document.createElement(\"div\");\n          marker_restaurant.innerHTML = ReactDOMServer.renderToStaticMarkup(\n          // <MarkerNavigation id=\"end-marker\" type=\"histories\" />\n          __jsx(\"div\", {\n            className: \"marker-histories\"\n          }, __jsx(\"div\", null, __jsx(\"img\", {\n            src: images.marker,\n            alt: \"\"\n          }))));\n          this.restaurant_marker = new maplibregl.Marker({\n            anchor: \"center\",\n            element: marker_restaurant\n          })\n          // .setPopup(popup)\n          .setLngLat(item.geometry.location).addTo(this.map);\n          this.listRestaurant.push(this.restaurant_marker);\n        }\n      } else {\n        // console.log('Có')\n        for (let marker of this.listRestaurant) {\n          marker.remove();\n        }\n        this.listRestaurant = [];\n      }\n    }\n    if (this.props.boxVisible === \"history\") {\n      for (let marker of this.listHistories) {\n        marker.remove();\n      }\n      for (let item of this.props.searchLocalStorage) {\n        const marker_history = document.createElement(\"div\");\n        marker_history.innerHTML = ReactDOMServer.renderToStaticMarkup(__jsx(\"div\", {\n          className: \"marker-histories\"\n        }, __jsx(\"div\", null, __jsx(\"img\", {\n          src: images.marker,\n          alt: \"\"\n        }))));\n        this.history_marker = new maplibregl.Marker({\n          anchor: \"center\",\n          element: marker_history\n        }).setLngLat(item.location).addTo(this.map);\n        this.listHistories.push(this.history_marker);\n      }\n    } else {\n      for (let marker of this.listHistories) {\n        marker.remove();\n      }\n    }\n\n    // if (this.props.boxVisible === \"details\") {\n    if (this.props.result_navigation && this.props.boxVisible === \"details\") {\n      for (let step of this.props.result_navigation.fastest[0].legs[0].steps) {\n        const popup = new maplibregl.Popup({\n          offset: [0, -32],\n          className: \"tooltip-marker\",\n          closeButton: false,\n          anchor: 'bottom'\n        }).setHTML(`<div class=\"ant-tooltip-inner tooltip-info-location\">${step.html_instructions}</div>`).setMaxWidth(\"150px\");\n        const marker_step = document.createElement('div');\n        marker_step.innerHTML = ReactDOMServer.renderToStaticMarkup(__jsx(\"div\", {\n          className: \"marker-details\"\n        }));\n        this.step_marker = new maplibregl.Marker({\n          anchor: 'center',\n          element: marker_step\n        }).setPopup(popup).setLngLat(step.end_location).addTo(this.map);\n        this.list.push(this.step_marker);\n      }\n    } else {\n      for (let marker of this.list) {\n        marker.remove();\n      }\n      this.list = [];\n    }\n    // }\n    if (this.props.boxVisible === \"navigation\" && isMobile) {\n      if (this.props.result_navigation) {\n        for (let step of this.props.result_navigation.fastest[0].legs[0].steps) {\n          const popup = new maplibregl.Popup({\n            offset: [0, -32],\n            className: \"tooltip-marker\",\n            closeButton: false,\n            anchor: 'bottom'\n          }).setHTML(`<div class=\"ant-tooltip-inner tooltip-info-location\">${step.html_instructions}</div>`).setMaxWidth(\"150px\");\n          const marker_step = document.createElement('div');\n          marker_step.innerHTML = ReactDOMServer.renderToStaticMarkup(__jsx(\"div\", {\n            className: \"marker-details\"\n          }));\n          this.step_marker = new maplibregl.Marker({\n            anchor: 'center',\n            element: marker_step\n          }).setPopup(popup).setLngLat(step.end_location).addTo(this.map);\n          this.list.push(this.step_marker);\n        }\n      } else {\n        for (let marker of this.list) {\n          marker.remove();\n        }\n        this.list = [];\n      }\n    }\n  }\n  decodePolyline(encoded) {\n    var points = [];\n    var index = 0,\n      len = encoded.length;\n    var lat = 0,\n      lng = 0;\n    while (index < len) {\n      var b,\n        shift = 0,\n        result = 0;\n      do {\n        b = encoded.charAt(index++).charCodeAt(0) - 63;\n        result |= (b & 0x1f) << shift;\n        shift += 5;\n      } while (b >= 0x20);\n      var dlat = result & 1 ? ~(result >> 1) : result >> 1;\n      lat += dlat;\n      shift = 0;\n      result = 0;\n      do {\n        b = encoded.charAt(index++).charCodeAt(0) - 63;\n        result |= (b & 0x1f) << shift;\n        shift += 5;\n      } while (b >= 0x20);\n      var dlng = result & 1 ? ~(result >> 1) : result >> 1;\n      lng += dlng;\n      points.push([lng * 1e-5, lat * 1e-5]);\n    }\n    return points;\n  }\n  componentDidMount() {\n    window.addEventListener('storage', this.handleStorageChange);\n    // console.log(STYLE_URL.NORMAL)\n    const selectedPlace = this.props.current_place;\n    this.map = new maplibregl.Map({\n      container: \"map\",\n      // container id\n      style: STYLE_URL.NORMAL + \"YJTajS80fLlhJ4a2BG0gXqXXdZzdLG5V3iivOK9e\",\n      center: selectedPlace ? [selectedPlace.geometry.location.lng, selectedPlace.geometry.location.lat] : [105.801982, 21.026745],\n      // starting position [lng, lat]\n      zoom: 12 // starting zoom\n    });\n    if (selectedPlace) this.props.dispatch(setRedMarkerAction(true, selectedPlace.geometry.location));\n    this.navigation = new maplibregl.NavigationControl();\n    this.geolocateControl = new maplibregl.GeolocateControl({\n      positionOptions: {\n        enableHighAccuracy: true\n      },\n      // Bật tắt hiển bị vị trí\n      trackUserLocation: true,\n      // Hiển thị\n      showUserLocation: true,\n      // Tắt vòng tròn to\n      showAccuracyCircle: false,\n      // Điều chỉnh mức zoom đến vị trí của mình\n      fitBoundsOptions: {\n        maxZoom: 15\n      }\n    });\n    this.geolocateControl.on(\"error\", () => {\n      _message.warning(\"Goong không thể lấy địa điểm hiện tại của bạn !\");\n    });\n    this.geolocateControl.on(\"geolocate\", e => {\n      this.props.dispatch(setMyLocationAction({\n        latitude: e.coords.latitude,\n        longitude: e.coords.longitude\n      }));\n    });\n    !isMobile && this.map.addControl(this.navigation);\n    !isMobile && this.map.addControl(this.geolocateControl);\n    this.map.on(\"click\", this._onMouseClick);\n    this.map.on(\"contextmenu\", this._onRightClick);\n    this.map.on(\"load\", () => {\n      var _URLSearchParams$get, _this$geolocateContro;\n      this.map.resize();\n      const pid = new URLSearchParams(window.location.search).get(\"pid\");\n      const location = (_URLSearchParams$get = new URLSearchParams(window.location.search).get(\"location\")) === null || _URLSearchParams$get === void 0 ? void 0 : _URLSearchParams$get.split(\",\");\n      const pid_around = new URLSearchParams(window.location.search).get(\"pid_around\");\n      const direction_infor = new URLSearchParams(window.location.search).get(\"direction\");\n      if (!direction_infor && !pid && !location && !pid_around && !this.props.current_place) (_this$geolocateContro = this.geolocateControl) === null || _this$geolocateContro === void 0 ? void 0 : _this$geolocateContro.trigger();else {\n        if (navigator.geolocation) {\n          navigator.geolocation.getCurrentPosition(position => {\n            this.props.dispatch(setMyLocationAction({\n              latitude: position.coords.latitude,\n              longitude: position.coords.longitude\n            }));\n          });\n        }\n      }\n    });\n    this.map.on(\"move\", () => {\n      this.props.dispatch(setCenterLatLngAction({\n        latitude: this.map.getCenter().lat,\n        longitude: this.map.getCenter().lng\n      }));\n    });\n    this.map.on(\"style.load\", () => {\n      var _this$map;\n      (_this$map = this.map) === null || _this$map === void 0 ? void 0 : _this$map.addLayer({\n        id: \"3d-buildings\",\n        source: \"composite\",\n        \"source-layer\": \"VN_Building\",\n        filter: [\"==\", \"extrude\", \"true\"],\n        type: \"fill-extrusion\",\n        minzoom: 15,\n        paint: {\n          \"fill-extrusion-color\": \"#aaa\",\n          \"fill-extrusion-height\": {\n            type: \"identity\",\n            property: \"height\"\n          },\n          \"fill-extrusion-base\": {\n            type: \"identity\",\n            property: \"min_height\"\n          },\n          \"fill-extrusion-opacity\": 0.4\n        }\n      });\n      if (this.props.result_navigation) {\n        if (this.props.result_select === \"fastest\") {\n          this.props.dispatch(selectResultAction(\"shortest\"));\n          this.props.dispatch(selectResultAction(\"fastest\"));\n        } else {\n          this.props.dispatch(selectResultAction(\"fastest\"));\n          this.props.dispatch(selectResultAction(\"shortest\"));\n        }\n      }\n    });\n    document.body.addEventListener(\"click\", this._onClickMenu);\n    // this.map.on('click', 'route-layer-fastest', (e) => {\n    //   console.log(e, 'fastest');\n    //   e.originalEvent.stopPropagation();\n    //   e.originalEvent.preventDefault();\n    // });\n\n    // this.map.on('click', 'route-layer-shortest', (e) => {\n    //   console.log(e)\n    // });\n\n    const direction_infor = new URLSearchParams(window.location.search).get(\"direction\");\n    const iframe = new URLSearchParams(window.location.search).get(\"iframe\");\n    if (direction_infor) {\n      const coor_from = {\n        lat: direction_infor.split(\"&\")[0].split(\",\")[0],\n        lng: direction_infor.split(\"&\")[0].split(\",\")[1]\n      };\n      const coor_to = {\n        lat: direction_infor.split(\"&\")[1].split(\",\")[0],\n        lng: direction_infor.split(\"&\")[1].split(\",\")[1]\n      };\n      if (coor_from.lat && coor_from.lng && coor_to.lat && coor_to.lng) {\n        // this.handleFromHere(coor_from.lat, coor_from.lng);\n        // this.handleToHere(coor_to.lat, coor_to.lng);\n        if (iframe != null) {\n          this.navigationByURLIframe(coor_from, coor_to);\n        } else {\n          this.navigationByURL(coor_from, coor_to);\n        }\n      }\n    }\n  }\n  componentWillUnmount() {\n    window.removeEventListener('storage', this.handleStorageChange);\n    document.body.removeEventListener(\"click\", this._onClickMenu);\n  }\n  render() {\n    var _placeMouseClick$geom, _placeMouseClick$geom2;\n    const {\n      style,\n      bottomInfoVisible,\n      placeMouseClick\n    } = this.state;\n    return __jsx(React.Fragment, null, __jsx(Div100vh, null, __jsx(\"div\", {\n      id: \"map\"\n    }), __jsx(\"div\", null, !isMobile && __jsx(_Avatar, {\n      shape: \"square\",\n      size: 64,\n      onClick: this.changeStyle,\n      className: \"change-status-button\",\n      style: {\n        backgroundImage: style === STYLE_URL.NORMAL + \"YJTajS80fLlhJ4a2BG0gXqXXdZzdLG5V3iivOK9e\" ? `url(${satellite_img})` : `url(${normal_map_img})`\n      }\n    }), isMobile && __jsx(_Avatar, {\n      shape: \"square\",\n      size: 64,\n      onClick: this.changeStyle,\n      className: \"change-status-button\"\n      // id='change-status-button--mobile'\n      ,\n      style: {\n        backgroundImage: style === STYLE_URL.NORMAL + \"YJTajS80fLlhJ4a2BG0gXqXXdZzdLG5V3iivOK9e\" ? `url(${satellite_img})` : `url(${normal_map_img})`\n      }\n    })), bottomInfoVisible && __jsx(BottomInfoLocation, {\n      changeVisibleBottomInfo: this.changeVisibleBottomInfo,\n      lat: ((_placeMouseClick$geom = placeMouseClick.geometry) === null || _placeMouseClick$geom === void 0 ? void 0 : _placeMouseClick$geom.location.lat) || Number(placeMouseClick.lng_lat[1]),\n      lng: ((_placeMouseClick$geom2 = placeMouseClick.geometry) === null || _placeMouseClick$geom2 === void 0 ? void 0 : _placeMouseClick$geom2.location.lng) || Number(placeMouseClick.lng_lat[0]),\n      name: placeMouseClick.name || placeMouseClick.address_components[0].long_name,\n      isMarkerAround: placeMouseClick.marker_type_id,\n      place_id: placeMouseClick._id,\n      address: this.getAddressGeocode(placeMouseClick) || placeMouseClick.formatted_address || placeMouseClick.description.address,\n      removeMarker: this.removeMarkerWhatIs\n    })));\n  }\n}\nconst mapStateToProps = state => {\n  return {\n    current_place: state.placeReducer.current_place,\n    from_place: state.navigationReducer.from,\n    to_place: state.navigationReducer.to,\n    boxVisible: state.boxVisibleReducer.box_visible,\n    result_navigation: state.navigationReducer.result,\n    viewport: state.placeReducer.viewport,\n    result_select: state.navigationReducer.result_select,\n    around_places: state.searchReducer.around_places,\n    markerSelect: state.boxVisibleReducer.red_marker_visible,\n    positionMarkerSelect: state.boxVisibleReducer.position_red_marker,\n    around_place_center: state.searchReducer.around_place_center,\n    popup_visible: state.boxVisibleReducer.popup_visible,\n    position_popup: state.boxVisibleReducer.position_popup,\n    type_popup: state.boxVisibleReducer.type_popup,\n    around_place_select: state.searchReducer.around_place_select,\n    my_location: state.placeReducer.my_location,\n    restaurantData: state.searchReducer.restaurant_data,\n    searchLocalStorage: state.searchReducer.search_local_storage\n  };\n};\nexport default connect(mapStateToProps)(Map);","map":{"version":3,"names":["React","Component","useEffect","STYLE_URL","Marker","connect","BottomInfoLocation","MenuRightClick","getDetailLatLngService","equal","setMapViewportAction","getDetailByLatLngAction","setCenterLatLngAction","setMyLocationAction","getDetailByIdAction","searchAroundAction","clearSearchAroundAction","selectAroundPlaceAction","selectResultAction","navigationFromAction","navigationToAction","clearResultAction","navigationAction","MarkerNavigation","setRedMarkerAction","setCollapsedInfoBoxAction","setPopupRightClick","setBoxVisibleAction","normal_map_img","satellite_img","ReactDOMServer","Axios","Div100vh","Request","Mile_Travel","isMobile","images","Map","constructor","props","_defineProperty","viewport","dispatch","e","boxVisible","removeMarkerWhatIs","setState","bottomInfoVisible","position","lat","lngLat","lng","evt","parent","target","parentElement","className","toString","includes","handleWhatIs","handleFromHere","handleToHere","handleDeleteLocation","handleSearchAround","handleToAroundPlace","visible","_this$props$position_","position_popup","_this$props$position_2","latLng","latitude","longitude","response","data","results","length","place_response","_objectSpread","name","address_components","long_name","formatted_address","getAddressGeocode","_message","error","_this$props$positionM","positionMarkerSelect","_this$props$positionM2","redMarkerVisible","place","_getInforPlace","zoom","placeMouseClick","markerWhatIs","setLngLat","addTo","map","el","document","createElement","innerHTML","renderToStaticMarkup","__jsx","size","maplibregl","anchor","getElement","addEventListener","stopPropagation","preventDefault","remove","id","get","_getInforPlaceAround","Number","lng_lat","isSmallScreen","selectPlace","geometry","location","to_place","changeVisibleBottomInfo","my_location","geocode","from_place","type_popup","type","selectAroundPlace","around_places","item","popupRightClick","getLngLat","_response$data","place_center","around_place_center","place_id","_id","description","address","markerCurrentPlace","redMarker","_place$address_compon","result","slice","push","join","style","state","SATELITE","NORMAL","setStyle","from","to","fromplace","toplace","event","console","log","key","value","newValue","_mapRef","createRef","popup_navigation","styleNormal","styleEarth","localStorage","getItem","list","listRestaurant","listHistories","view","navigationView","componentDidUpdate","prevProps","navigation","NavigationControl","addControl","removeControl","element","markerSelect","_this$redMarker","popup_visible","setHTML","Popup","closeButton","closeOnClick","offset","current_place","selectedPlace","flyTo","center","speed","curve","removeMarkerPopup","result_select","result_navigation","dashedLineGeoJSON","polylineGeoJSON","_this$popup_navigatio","_this$popup_navigatio2","getLayer","removeLayer","getSource","removeSource","distance","fastest","legs","toFixed","MILES","coordinateObject1","coordinates","decodePolyline","overview_polyline","points","roadWay","coordinateObject2","shortest","i","addSource","properties","addLayer","source","layout","paint","_this$popup_navigatio3","Math","trunc","duration","text","setMaxWidth","getElementById","normalizeBounds","bounds","firstPoint","secondPoint","minLat","min","maxLat","max","minLng","maxLng","bound","cameraForBounds","padding","top","bottom","left","right","popup","start_marker","setPopup","marker_start","src","button","width","alt","isOpen","togglePopup","_prevProps$from_place","_this$state$placeMous","end_marker","marker_end","marker","_this$start_marker","_prevProps$to_place","_this$state$placeMous2","around_place_select","_this$list_marker_aro","list_marker_around","forEach","markerCenterDiv","_selectAroundPlace","getPopup","place_select","markerDiv","_this$props$current_p","_this$props$current_p2","restaurantData","marker_restaurant","restaurant_marker","searchLocalStorage","marker_history","history_marker","step","steps","html_instructions","marker_step","step_marker","end_location","encoded","index","len","b","shift","charAt","charCodeAt","dlat","dlng","componentDidMount","window","handleStorageChange","container","geolocateControl","GeolocateControl","positionOptions","enableHighAccuracy","trackUserLocation","showUserLocation","showAccuracyCircle","fitBoundsOptions","maxZoom","on","warning","coords","_onMouseClick","_onRightClick","_URLSearchParams$get","_this$geolocateContro","resize","pid","URLSearchParams","search","split","pid_around","direction_infor","trigger","navigator","geolocation","getCurrentPosition","getCenter","_this$map","filter","minzoom","property","body","_onClickMenu","iframe","coor_from","coor_to","navigationByURLIframe","navigationByURL","componentWillUnmount","removeEventListener","render","_placeMouseClick$geom","_placeMouseClick$geom2","Fragment","_Avatar","shape","onClick","changeStyle","backgroundImage","isMarkerAround","marker_type_id","removeMarker","mapStateToProps","placeReducer","navigationReducer","boxVisibleReducer","box_visible","searchReducer","red_marker_visible","position_red_marker","restaurant_data","search_local_storage"],"sources":["D:/Workhome/ParkingLot/live-map/components/Map.jsx"],"sourcesContent":["import React, { Component, useEffect } from \"react\";\nimport { STYLE_URL } from \"../consts\";\nimport Marker from \"./Marker\";\nimport { connect } from \"react-redux\";\nimport BottomInfoLocation from \"./BottomInfoLocation\";\nimport MenuRightClick from \"./MenuRightCLick\";\nimport { getDetailLatLngService } from \"../redux/sagas/placeSaga\";\nimport { message, Avatar } from \"antd\";\nimport equal from \"fast-deep-equal/es6/react\";\nimport {\n  setMapViewportAction,\n  getDetailByLatLngAction,\n  setCenterLatLngAction,\n  setMyLocationAction,\n  getDetailByIdAction\n} from \"../redux/actions/place\";\nimport {\n  searchAroundAction,\n  clearSearchAroundAction,\n  selectAroundPlaceAction,\n} from \"../redux/actions/search\";\nimport {\n  selectResultAction,\n  navigationFromAction,\n  navigationToAction,\n  clearResultAction,\n  navigationAction\n} from \"../redux/actions/navigation\";\nimport MarkerNavigation from \"./MarkerNavigation\";\nimport {\n  setRedMarkerAction,\n  setCollapsedInfoBoxAction,\n  setPopupRightClick,\n  setBoxVisibleAction,\n} from \"../redux/actions/boxVisble\";\nimport normal_map_img from \"../static/images/normal_map.png\";\nimport satellite_img from \"../static/images/satellite.jpeg\";\nimport ReactDOMServer from \"react-dom/server\";\nimport Axios from \"axios\";\nimport Div100vh from \"react-div-100vh\";\nimport Request from \"../utils/request\";\nimport { Mile_Travel } from \"../consts\";\nimport { isMobile } from \"react-device-detect\";\nimport images from '../utils/images';\n// import { STYLE_KEY } from \"../config.dev\";\n\nclass Map extends Component {\n  constructor(props) {\n    super(props);\n    this._mapRef = React.createRef();\n    this.map = null;\n    this.redMarker = null;\n    this.popupRightClick = null;\n    this.popup_navigation = [];\n    this.state = {\n      style: STYLE_URL.NORMAL + STYLE_KEY,\n      styleNormal: STYLE_URL.NORMAL + STYLE_KEY,\n      styleEarth: STYLE_URL.SATELITE + STYLE_KEY,\n      bottomInfoVisible: false,\n      value: localStorage.getItem('search_history') || '',\n    };\n    this.list = [];\n    this.listRestaurant = [];\n    this.listHistories = [];\n    this.view = null;\n    this.navigationView = null\n  }\n\n  _onViewportChange = (viewport) => {\n    this.props.dispatch(setMapViewportAction(viewport));\n  };\n\n  _onMouseClick = (e) => {\n    this.props.dispatch(setPopupRightClick(false));\n    if (this.props.boxVisible !== \"iframe\") {\n      this.props.dispatch(setRedMarkerAction(false));\n    }\n    // if (this.props.boxVisible === \"info\") this.props.dispatch(setBoxVisibleAction('search'))\n    // this.markerWhatIs ? this.markerWhatIs.remove() : null;\n    this.props.dispatch(selectAroundPlaceAction(null));\n    this.removeMarkerWhatIs();\n    this.setState({\n      bottomInfoVisible: false,\n    });\n  };\n\n  _onRightClick = (e) => {\n    const position = { lat: e.lngLat.lat, lng: e.lngLat.lng };\n    if (this.props.boxVisible !== \"iframe\") {\n      this.props.dispatch(setRedMarkerAction(true, position));\n      this.props.dispatch(setPopupRightClick(true, position, \"normal\"));\n    }\n  };\n\n  _onClickMenu = (evt) => {\n    const parent = evt.target.parentElement;\n\n    if (\n      evt.target.className &&\n      evt.target.className.toString().includes(\"what-is-this\")\n    ) {\n      this.handleWhatIs();\n    } else if (\n      evt.target.className &&\n      evt.target.className.toString().includes(\"from-here\")\n    ) {\n      this.handleFromHere();\n    } else if (\n      evt.target.className &&\n      evt.target.className.toString().includes(\"to-here\")\n    ) {\n      this.handleToHere();\n    } else if (\n      evt.target.className &&\n      evt.target.className.toString().includes(\"delete-location\")\n    ) {\n      this.handleDeleteLocation();\n    } else if (\n      evt.target.className &&\n      evt.target.className.toString().includes(\"search-around\")\n    ) {\n      this.handleSearchAround();\n    } else if (\n      evt.target.className &&\n      evt.target.className.toString().includes(\"to-around-place\")\n    ) {\n      this.handleToAroundPlace();\n    } else if (\n      evt.target.className &&\n      evt.target.className.toString().includes(\"what-is-navigation\")\n    ) {\n      this.handleWhatIs(false);\n    }\n    if (\n      parent?.className &&\n      parent?.className.toString().includes(\"menu-right-click\")\n    ) {\n      if (\n        evt.target.className &&\n        !evt.target.className.toString().includes(\"what-is-this\")\n      ) {\n        this.props.dispatch(clearSearchAroundAction());\n      }\n      this.props.dispatch(setPopupRightClick(false));\n      this.removeMarkerWhatIs();\n    }\n  };\n\n  changeVisibleBottomInfo = (visible) => {\n    this.setState({\n      bottomInfoVisible: visible,\n    });\n  };\n\n  _getInforPlace = async (\n    lat = this.props.position_popup?.lat,\n    lng = this.props.position_popup?.lng\n  ) => {\n    const latLng = {\n      latitude: lat,\n      longitude: lng,\n    };\n\n    try {\n      const response = await getDetailLatLngService(latLng);\n      if (response.data.results.length > 0) {\n        const place_response = response.data.results[0];\n        return {\n          ...place_response,\n          name: place_response.address_components[0].long_name,\n          formatted_address: this.getAddressGeocode(place_response),\n        };\n      } else {\n        message.error(\"Không tìm thấy địa điểm !!\");\n        return null;\n      }\n    } catch (error) {\n      throw error;\n    }\n  };\n\n  selectPlace = async (\n    lat = this.props.positionMarkerSelect?.lat,\n    lng = this.props.positionMarkerSelect?.lng,\n    redMarkerVisible = true\n  ) => {\n    const place = await this._getInforPlace(lat, lng);\n\n    if (place) {\n      const viewport = {\n        longitude: lng,\n        latitude: lat,\n        zoom: 15,\n      };\n      this.props.dispatch(setMapViewportAction(viewport));\n      this.setState({\n        bottomInfoVisible: true,\n        placeMouseClick: place,\n      });\n      if (redMarkerVisible) {\n        if (this.markerWhatIs) {\n          this.markerWhatIs.setLngLat({ lat, lng }).addTo(this.map);\n        } else {\n          const el = document.createElement(\"div\");\n          el.innerHTML = ReactDOMServer.renderToStaticMarkup(\n            <Marker size={22} />\n          );\n          this.markerWhatIs = new maplibregl.Marker(el, { anchor: \"bottom\" })\n            .setLngLat({ lat, lng })\n            .addTo(this.map);\n        }\n        this.markerWhatIs.getElement().addEventListener(\"contextmenu\", (e) => {\n          e.stopPropagation();\n          e.preventDefault();\n          this.props.dispatch(setRedMarkerAction(false));\n          this.props.dispatch(\n            setPopupRightClick(true, { lat, lng }, \"popupCurrentPlace\")\n          );\n        });\n        this.props.dispatch(setRedMarkerAction(false));\n      }\n      // redMarkerVisible ? this.props.dispatch(setRedMarkerAction(true, { lat, lng })) : null;\n    } else {\n      message.error(\"Không tìm thấy địa điểm !!\");\n    }\n  };\n\n  removeMarkerWhatIs = () => {\n    this.markerWhatIs ? this.markerWhatIs.remove() : null;\n  };\n\n  _getInforPlaceAround = async (id) => {\n    try {\n      const response = await Axios.get(\n        `https://napi.goong.io/v1/marker/get_marker_detail/${id}`\n      );\n\n      if (response.data.data) {\n        return response.data.data;\n      } else {\n        message.error(\"Không tìm thấy địa điểm !!\");\n        return null;\n      }\n    } catch (error) {\n      message.error(\"Không tìm thấy địa điểm !\");\n      throw error;\n    }\n  };\n\n  selectAroundPlace = async (id) => {\n    const place = await this._getInforPlaceAround(id);\n    if (place) {\n      const viewport = {\n        longitude: Number(place.lng_lat[0]),\n        latitude: Number(place.lng_lat[1]),\n        zoom: 15,\n      };\n      this.props.dispatch(setMapViewportAction(viewport));\n      this.setState({\n        bottomInfoVisible: true,\n        placeMouseClick: place,\n      });\n      this.props.dispatch(setPopupRightClick(false));\n    } else {\n      message.error(\"Không tìm thấy địa điểm !!\");\n    }\n  };\n\n  handleWhatIs = (redMarkerVisible = true) => {\n    const { position_popup, isSmallScreen } = this.props;\n    if (isSmallScreen) {\n      this.props.dispatch(\n        getDetailByLatLngAction({\n          latitude: position_popup.lat,\n          longitude: position_popup.lng,\n        })\n      );\n\n      this.props.dispatch(setBoxVisibleAction(\"info\"));\n      this.props.dispatch(clearSearchAroundAction());\n      this.props.dispatch(setPopupRightClick(false));\n      this.removeMarkerWhatIs();\n    } else {\n      this.selectPlace(\n        position_popup.lat,\n        position_popup.lng,\n        redMarkerVisible\n      );\n    }\n  };\n\n  handleFromHere = async (lat, lng) => {\n\n    let place;\n    if (!lat || !lng) place = await this._getInforPlace();\n    else {\n      place = await this._getInforPlace(lat, lng);\n    }\n    if (place) {\n      const viewport = {\n        longitude: place.geometry.location.lng,\n        latitude: place.geometry.location.lat,\n        zoom: 15,\n      };\n      !this.props.to_place &&\n        this.props.dispatch(setMapViewportAction(viewport));\n      this.props.dispatch(setBoxVisibleAction(\"navigation\"));\n      this.props.dispatch(\n        navigationFromAction(\n          place,\n          `${place.name} - ${place.formatted_address}`\n        )\n      );\n\n\n      this.props.dispatch(setRedMarkerAction(false));\n      this.changeVisibleBottomInfo(false);\n    }\n  };\n\n  handleToHere = async (lat, lng) => {\n    let place;\n    if (!lat || !lng) place = await this._getInforPlace();\n    else {\n      place = await this._getInforPlace(lat, lng);\n    }\n    if (place) {\n      this.props.dispatch(setBoxVisibleAction(\"navigation\"));\n      const viewport = {\n        longitude: place.geometry.location.lng,\n        latitude: place.geometry.location.lat,\n        zoom: 15,\n      };\n      const my_location = this.props.my_location;\n      if (\n        my_location &&\n        (this.props.boxVisible === \"search\" || this.props.boxVisible === \"info\")\n      ) {\n        try {\n          const response = await Request.geocode(my_location);\n          if (response.data.results.length > 0) {\n            this.props.dispatch(\n              navigationFromAction(\n                {\n                  ...response.data.results[0],\n                  name: response.data.results[0].address_components[0]\n                    .long_name,\n                },\n                \"Vị trí của bạn\"\n              )\n            );\n          }\n        } catch (error) {\n          throw error;\n        }\n      }\n      !this.props.from_place &&\n        this.props.dispatch(setMapViewportAction(viewport));\n      this.props.dispatch(\n        navigationToAction(place, `${place.name} - ${place.formatted_address}`)\n      );\n      this.props.dispatch(setBoxVisibleAction(\"navigation\"));\n      this.props.dispatch(setRedMarkerAction(false));\n      this.changeVisibleBottomInfo(false);\n    }\n  };\n\n  handleDeleteLocation = () => {\n    const { type_popup } = this.props;\n    if (type_popup === \"popupFromPlace\") {\n      this.props.dispatch(navigationFromAction(null, \"\"));\n    } else if (type_popup === \"popupToPlace\") {\n      this.props.dispatch(navigationToAction(null, \"\"));\n    }\n    this.props.dispatch(clearResultAction());\n  };\n\n  handleSearchAround = async () => {\n    const place = await this._getInforPlace();\n    if (place) {\n      const viewport = {\n        longitude: place.geometry.location.lng,\n        latitude: place.geometry.location.lat,\n        zoom: 15,\n      };\n      const location = {\n        lat: place.geometry.location.lat,\n        lng: place.geometry.location.lng,\n      };\n      this.props.dispatch(setBoxVisibleAction(\"search\"));\n      this.props.dispatch(setMapViewportAction(viewport));\n      this.props.dispatch(\n        searchAroundAction(location, this.props.viewport.zoom)\n      );\n      this.setState({\n        bottomInfoVisible: false,\n      });\n    }\n  };\n\n  _selectAroundPlace = (type, place) => {\n    if (type !== \"center\") {\n      this.props.dispatch(selectAroundPlaceAction(place));\n      this.selectAroundPlace(place?.id);\n    } else {\n      this.props.dispatch(selectAroundPlaceAction(place));\n      this.selectPlace(\n        place.geometry.location.lat,\n        place.geometry.location.lng,\n        false\n      );\n    }\n  };\n\n  handleToAroundPlace = async () => {\n    let place = null;\n    this.props.around_places.map((item) => {\n      if (\n        item.lng_lat[0] * 1 === this.popupRightClick.getLngLat().lng &&\n        item.lng_lat[1] * 1 === this.popupRightClick.getLngLat().lat\n      ) {\n        place = item;\n      }\n    });\n    if (place) {\n      try {\n        this.props.dispatch(setPopupRightClick(false));\n        const place_center = this.props.around_place_center;\n        this.props.dispatch(\n          navigationFromAction(\n            place_center,\n            `${place_center.name} - ${place_center.formatted_address}`\n          )\n        );\n        const response = await Axios.get(\n          `https://napi.goong.io/v1/marker/get_marker_detail/${place.id}`\n        );\n\n        place = response.data?.data;\n        place = {\n          ...place,\n          place_id: place._id,\n          geometry: {\n            location: {\n              lat: Number(place.lng_lat[1]),\n              lng: Number(place.lng_lat[0]),\n            },\n          },\n          formatted_address: place.description.address,\n        };\n        this.props.dispatch(\n          navigationToAction(\n            place,\n            `${place.name} - ${place.formatted_address}`\n          )\n        );\n        this.props.dispatch(setBoxVisibleAction(\"navigation\"));\n      } catch (error) {\n        message.error(\"Không tìm thấy địa điểm !\");\n      }\n    } else {\n      message.error(\"Không tìm thấy địa điểm !\");\n    }\n  };\n\n  removeMarkerPopup = () => {\n    if (this.markerCurrentPlace) this.markerCurrentPlace.remove();\n    if (this.popupRightClick) this.popupRightClick.remove();\n    if (this.props.around_places)\n      this.props.dispatch(clearSearchAroundAction());\n    if (this.redMarker) this.redMarker.remove();\n  };\n\n  getAddressGeocode = (place) => {\n    let result = [];\n    place.address_components?.slice(1).map((item) => {\n      result.push(item.long_name);\n    });\n    return result.join(\",\");\n  };\n\n  componentDidUpdate(prevProps) {\n    if (this.props.isSmallScreen !== prevProps.isSmallScreen) {\n      if (!this.props.isSmallScreen && !this.navigation) {\n        this.navigation = new maplibregl.NavigationControl();\n        this.map.addControl(this.navigation);\n      } else if (this.props.isSmallScreen && this.navigation) {\n        this.map.removeControl(this.navigation);\n        this.navigation = null;\n      }\n    }\n\n    if (\n      !equal(prevProps.positionMarkerSelect, this.props.positionMarkerSelect) &&\n      this.props.positionMarkerSelect\n    ) {\n      if (this.redMarker) {\n        this.redMarker = this.redMarker\n          .setLngLat(this.props.positionMarkerSelect)\n          .addTo(this.map);\n      } else {\n        const el = document.createElement(\"div\");\n        el.innerHTML = ReactDOMServer.renderToStaticMarkup(\n          <Marker size={22} />\n        );\n        // Marker chuột phải\n        this.redMarker = new maplibregl.Marker({ anchor: \"bottom\", element: el })\n          .setLngLat(this.props.positionMarkerSelect)\n          .addTo(this.map);\n\n        this.redMarker.getElement().addEventListener(\"contextmenu\", (e) => {\n          e.stopPropagation();\n          e.preventDefault();\n          this.props.dispatch(\n            setPopupRightClick(true, this.props.positionMarkerSelect, \"normal\")\n          );\n        });\n      }\n    }\n\n    if (prevProps.markerSelect !== this.props.markerSelect) {\n      if (!this.props.markerSelect) {\n        this.redMarker?.remove();\n      }\n    }\n\n    if (\n      this.props.popup_visible &&\n      (!equal(prevProps.position_popup, this.props.position_popup) ||\n        this.props.type_popup !== prevProps.type_popup) &&\n      this.props.position_popup\n    ) {\n      this.popupRightClick = this.popupRightClick\n        ? this.popupRightClick\n          .setLngLat([\n            this.props.position_popup.lng,\n            this.props.position_popup.lat,\n          ])\n          .addTo(this.map)\n          .setHTML(\n            ReactDOMServer.renderToStaticMarkup(\n              <MenuRightClick\n                dispatch={this.props.dispatch}\n                position_popup={this.props.position_popup}\n                type_popup={this.props.type_popup}\n              />\n            )\n          )\n        : new maplibregl.Popup({\n          closeButton: false,\n          anchor: \"top\",\n          closeOnClick: false,\n          offset: [0, 5],\n        })\n          .setLngLat([\n            this.props.position_popup.lng,\n            this.props.position_popup.lat,\n          ])\n          .setHTML(\n            ReactDOMServer.renderToStaticMarkup(\n              <MenuRightClick\n                dispatch={this.props.dispatch}\n                position_popup={this.props.position_popup}\n                type_popup={this.props.type_popup}\n              />\n            )\n          )\n          .addTo(this.map);\n    }\n\n    if (this.popupRightClick && !this.props.popup_visible) {\n      this.popupRightClick.remove();\n    }\n\n    if (\n      !equal(prevProps.current_place, this.props.current_place) &&\n      this.props.current_place\n    ) {\n      const selectedPlace = this.props.current_place;\n\n      this.map.flyTo({\n        center: [\n          selectedPlace.geometry.location.lng,\n          selectedPlace.geometry.location.lat,\n        ],\n        zoom: 15,\n        speed: 1.5,\n        curve: 1,\n      });\n      this.props.dispatch(setCollapsedInfoBoxAction(false));\n      this.props.dispatch(setRedMarkerAction(false));\n      this.setState({\n        bottomInfoVisible: false,\n      });\n    }\n\n    if (\n      !equal(prevProps.viewport, this.props.viewport) &&\n      this.props.viewport\n    ) {\n      this.map.flyTo({\n        center: [this.props.viewport.longitude, this.props.viewport.latitude],\n        zoom: this.props.viewport.zoom,\n        speed: 2,\n      });\n    }\n\n    if (!equal(prevProps.around_place_center, this.props.around_place_center)) {\n      this.props.dispatch(setRedMarkerAction(false));\n    }\n\n    if (\n      !equal(prevProps.boxVisible, this.props.boxVisible) &&\n      this.props.boxVisible === \"navigation\"\n    ) {\n      this.removeMarkerPopup();\n    }\n\n    if (\n      !equal(prevProps.result_select, this.props.result_select) ||\n      !equal(prevProps.result_navigation, this.props.result_navigation)\n    ) {\n      const {\n        result_select,\n        result_navigation,\n        boxVisible,\n        from_place,\n        to_place,\n      } = this.props;\n      let dashedLineGeoJSON = [],\n        polylineGeoJSON = [];\n      this.result_navigation = [];\n\n      if ((boxVisible !== \"navigation\" && boxVisible !== \"iframe\") || !result_navigation) {\n        // Remove cac layer/source\n        if (this.map.getLayer(`route-layer-fastest`))\n          this.map.removeLayer(`route-layer-fastest`);\n        if (this.map.getLayer(`route-layer-shortest`))\n          this.map.removeLayer(`route-layer-shortest`);\n        if (this.map.getLayer(`walk-layer-0`))\n          this.map.removeLayer(`walk-layer-0`);\n        if (this.map.getLayer(`walk-layer-1`))\n          this.map.removeLayer(`walk-layer-1`);\n\n        if (this.map.getSource(`route-source-fastest`))\n          this.map.removeSource(`route-source-fastest`);\n        if (this.map.getSource(`route-source-shortest`))\n          this.map.removeSource(`route-source-shortest`);\n        if (this.map.getSource(`walk-source-0`))\n          this.map.removeSource(`walk-source-0`);\n        if (this.map.getSource(`walk-source-1`))\n          this.map.removeSource(`walk-source-1`);\n\n        this.popup_navigation[0]?.remove();\n        this.popup_navigation[1]?.remove();\n      } else {\n        if (result_navigation) {\n          let distance = \"\";\n          if (localStorage.getItem(\"unit\") === \"KILOMETERS\") {\n            distance = `${(\n              result_navigation.fastest[0].legs[0].distance.value / 1000\n            ).toFixed(1)} KM`;\n          } else if (localStorage.getItem(\"unit\") === \"MILES\") {\n            distance = `${(\n              (result_navigation.fastest[0].legs[0].distance.value / 1000) *\n              Mile_Travel.MILES\n            ).toFixed(1)} Dặm`;\n          } else {\n            distance = `${(\n              result_navigation.fastest[0].legs[0].distance.value / 1000\n            ).toFixed(1)} KM`;\n          }\n          let coordinateObject1 = {};\n          coordinateObject1.coordinates = this.decodePolyline(\n            result_navigation.fastest[0].overview_polyline.points\n          );\n          coordinateObject1.type = \"LineString\";\n          polylineGeoJSON.push(coordinateObject1);\n          polylineGeoJSON[0].roadWay = \"fastest\";\n          let coordinateObject2 = {};\n          coordinateObject2.coordinates = this.decodePolyline(\n            result_navigation.shortest[0].overview_polyline.points\n          );\n          coordinateObject2.type = \"LineString\";\n          polylineGeoJSON.push(coordinateObject2);\n          polylineGeoJSON[1].roadWay = \"shortest\";\n\n          dashedLineGeoJSON.push({\n            type: \"LineString\",\n            coordinates: [\n              [\n                polylineGeoJSON[0].coordinates[0][0],\n                polylineGeoJSON[0].coordinates[0][1],\n              ],\n              [\n                from_place?.geometry.location.lng,\n                from_place?.geometry.location.lat,\n              ],\n            ],\n          });\n          dashedLineGeoJSON.push({\n            type: \"LineString\",\n            coordinates: [\n              [\n                polylineGeoJSON[0].coordinates[\n                polylineGeoJSON[0].coordinates.length - 1\n                ][0],\n                polylineGeoJSON[0].coordinates[\n                polylineGeoJSON[0].coordinates.length - 1\n                ][1],\n              ],\n              [\n                to_place?.geometry.location.lng,\n                to_place?.geometry.location.lat,\n              ],\n            ],\n          });\n\n          polylineGeoJSON.map((item, i) => {\n            // Layer dan duong\n            if (this.map.getLayer(`route-layer-${item.roadWay}`))\n              this.map.removeLayer(`route-layer-${item.roadWay}`);\n            if (this.map.getSource(`route-source-${item.roadWay}`))\n              this.map.removeSource(`route-source-${item.roadWay}`);\n            this.map.addSource(`route-source-${item.roadWay}`, {\n              type: \"geojson\",\n              data: {\n                type: \"Feature\",\n                properties: {},\n                geometry: item,\n              },\n            });\n            this.map.addLayer({\n              id: `route-layer-${item.roadWay}`,\n              type: \"line\",\n              source: `route-source-${item.roadWay}`,\n              layout: {\n                \"line-join\": \"round\",\n                \"line-cap\": \"round\",\n              },\n              paint: {\n                \"line-color\": \"rgb(24, 144, 255)\",\n                \"line-width\": 7,\n                \"line-opacity\": item.roadWay === result_select ? 1 : 0.5,\n              },\n            });\n            // Layer di bo\n\n            if (this.map.getLayer(`walk-layer-${i}`))\n              this.map.removeLayer(`walk-layer-${i}`);\n            if (this.map.getSource(`walk-source-${i}`))\n              this.map.removeSource(`walk-source-${i}`);\n            this.map.addSource(`walk-source-${i}`, {\n              type: \"geojson\",\n              data: {\n                type: \"Feature\",\n                properties: {},\n                geometry: dashedLineGeoJSON[i],\n              },\n            });\n            this.map.addLayer({\n              id: `walk-layer-${i}`,\n              type: \"line\",\n              source: `walk-source-${i}`,\n              layout: {\n                \"line-join\": \"round\",\n                \"line-cap\": \"round\",\n              },\n              paint: {\n                \"line-color\": \"rgb(133, 135, 126)\",\n                \"line-opacity\": 1,\n                \"line-width\": 6,\n                \"line-dasharray\": [0.2, 2],\n              },\n            });\n            // Add Popup hien ket qua\n\n            if (this.popup_navigation[i]) {\n              this.popup_navigation[i]?.remove();\n              this.popup_navigation[i] = null;\n            }\n            this.popup_navigation[i] = new maplibregl.Popup({\n              closeButton: false,\n              anchor: \"top\",\n              closeOnClick: false,\n              className:\n                item.roadWay === result_select\n                  ? \"popup-z-index1\"\n                  : \"popup-z-index2\",\n            })\n              .setLngLat([\n                i === 0\n                  ? item.coordinates[\n                  Math.trunc(0.75 * item.coordinates.length)\n                  ][0]\n                  : item.coordinates[\n                  Math.trunc(0.25 * item.coordinates.length)\n                  ][0],\n                i === 0\n                  ? item.coordinates[\n                  Math.trunc(item.coordinates.length * 0.75)\n                  ][1]\n                  : item.coordinates[\n                  Math.trunc(item.coordinates.length * 0.25)\n                  ][1],\n              ])\n              .setHTML(\n                ReactDOMServer.renderToStaticMarkup(\n                  <div\n                    className=\"tooltipNavigation\"\n                    id={`popup-${item.roadWay}`}\n                  >\n                    <p>{distance}</p>\n                    <p>\n                      {result_navigation[item.roadWay][0].legs[0].duration.text}\n                    </p>\n                  </div>\n                )\n              )\n              .setMaxWidth(\"300px\")\n              .addTo(this.map);\n            document\n              .getElementById(`popup-${item.roadWay}`)\n              .addEventListener(\"click\", () => {\n                this.props.dispatch(selectResultAction(item.roadWay));\n              });\n            const normalizeBounds = (bounds) => {\n              const [firstPoint, secondPoint] = bounds;\n\n              const minLat = Math.min(firstPoint[1], secondPoint[1]);\n              const maxLat = Math.max(firstPoint[1], secondPoint[1]);\n\n              const minLng = Math.min(firstPoint[0], secondPoint[0]);\n              const maxLng = Math.max(firstPoint[0], secondPoint[0]);\n\n              return [\n                [minLng, minLat],\n                [maxLng, maxLat]\n              ];\n            };\n            const bound = normalizeBounds([item.coordinates[0], item.coordinates[item.coordinates.length - 1]])\n            if (isMobile) {\n              this.navigationView = this.map.cameraForBounds(bound, {\n                padding: { top: 10, bottom: 25, left: 24, right: 24 }\n              })\n            } else {\n              this.navigationView = this.map.cameraForBounds(bound, {\n                padding: { top: 40, bottom: 40, left: 200, right: 40 }\n              })\n            }\n          });\n\n          this.view = {\n            latitude: this.navigationView.center.lat,\n            longitude: this.navigationView.center.lng,\n            zoom: this.navigationView.zoom\n          }\n        }\n      }\n\n      this.props.dispatch(setMapViewportAction(this.view))\n    }\n    if (!equal(prevProps.from_place, this.props.from_place)) {\n      const place = this.props.from_place;\n      if (place) {\n        const popup = new maplibregl.Popup({\n          offset: [0, -18],\n          className: \"tooltip-marker\",\n          closeButton: false,\n        })\n          .setHTML(\n            `<div class=\"ant-tooltip-inner tooltip-info-location\">${place.name}</div>`\n          )\n          .setMaxWidth(\"150px\");\n        if (this.start_marker) {\n          this.start_marker = this.start_marker\n            .setLngLat(place.geometry.location)\n            .setPopup(popup)\n            .addTo(this.map);\n        } else {\n          const marker_start = document.createElement(\"div\");\n          marker_start.innerHTML = ReactDOMServer.renderToStaticMarkup(\n            <div className='marker-start'>\n              <img src={images.button} style={{ width: 12 }} alt=\"\" />\n            </div>\n          );\n          this.start_marker = new maplibregl.Marker({\n            anchor: \"center\",\n            element: marker_start,\n          })\n            .setPopup(popup)\n            .setLngLat(place.geometry.location)\n            .addTo(this.map);\n          this.start_marker\n            .getElement()\n            .addEventListener(\"contextmenu\", (e) => {\n              e.stopPropagation();\n              e.preventDefault();\n              const lngLat = this.start_marker.getLngLat();\n              this.props.dispatch(\n                setPopupRightClick(true, lngLat, \"popupFromPlace\")\n              );\n              this.props.dispatch(setRedMarkerAction(false));\n            });\n          this.start_marker.getElement().addEventListener(\"click\", () => {\n            if (popup.isOpen()) {\n              this.start_marker.togglePopup();\n            }\n          });\n          this.start_marker\n            .getElement()\n            .addEventListener(\"mouseenter\", () =>\n              this.start_marker.togglePopup()\n            );\n          this.start_marker\n            .getElement()\n            .addEventListener(\"mouseleave\", () =>\n              this.start_marker.togglePopup()\n            );\n        }\n      } else {\n        if (equal(this.start_marker.getLngLat(), this.props.position_popup)) {\n          this.props.dispatch(setPopupRightClick(false));\n        }\n        if (\n          equal(\n            prevProps.from_place?.place_id,\n            this.state.placeMouseClick?.place_id\n          )\n        ) {\n          this.changeVisibleBottomInfo(false);\n        }\n        this.changeVisibleBottomInfo(false);\n        this.start_marker ? this.start_marker.remove() : null;\n      }\n    }\n\n    if (!equal(prevProps.to_place, this.props.to_place)) {\n      const place = this.props.to_place;\n      if (place) {\n        const popup = new maplibregl.Popup({\n          offset: [0, -18],\n          className: \"tooltip-marker\",\n          closeButton: false,\n        })\n          .setHTML(\n            `<div class=\"ant-tooltip-inner tooltip-info-location\">${place.name}</div>`\n          )\n          .setMaxWidth(\"150px\");\n        if (this.end_marker) {\n          this.to_place = this.end_marker\n            .setPopup(popup)\n            .setLngLat(place.geometry.location)\n            .addTo(this.map);\n        } else {\n          const marker_end = document.createElement(\"div\");\n          marker_end.innerHTML = ReactDOMServer.renderToStaticMarkup(\n            <div className='marker-end'>\n              <div>\n                <img src={images.marker} alt=\"\" />\n              </div>\n            </div>\n          );\n          this.end_marker = new maplibregl.Marker({\n            anchor: \"center\",\n            element: marker_end,\n          })\n            .setPopup(popup)\n            .setLngLat(place.geometry.location)\n            .addTo(this.map);\n          this.end_marker.getElement().addEventListener(\"contextmenu\", (e) => {\n            e.stopPropagation();\n            e.preventDefault();\n            const lngLat = this.end_marker.getLngLat();\n            this.props.dispatch(\n              setPopupRightClick(true, lngLat, \"popupToPlace\")\n            );\n            this.props.dispatch(setRedMarkerAction(false));\n          });\n          this.end_marker.getElement().addEventListener(\"click\", () => {\n            if (popup.isOpen()) {\n              this.end_marker.togglePopup();\n            }\n          });\n          this.end_marker\n            .getElement()\n            .addEventListener(\"mouseenter\", () =>\n              this.end_marker.togglePopup()\n            );\n          this.end_marker\n            .getElement()\n            .addEventListener(\"mouseleave\", () =>\n              this.end_marker.togglePopup()\n            );\n        }\n      } else {\n        if (equal(this.start_marker?.getLngLat(), this.props.position_popup)) {\n          this.props.dispatch(setPopupRightClick(false));\n        }\n\n        if (\n          equal(\n            prevProps.to_place?.place_id,\n            this.state.placeMouseClick?.place_id\n          )\n        ) {\n          this.changeVisibleBottomInfo(false);\n        }\n        this.end_marker ? this.end_marker.remove() : null;\n      }\n    }\n\n    if (\n      !equal(prevProps.around_places, this.props.around_places) ||\n      !equal(prevProps.around_place_select, this.props.around_place_select)\n    ) {\n      if (this.list_marker_around?.length > 0) {\n        this.list_marker_around.forEach((item) => {\n          item.remove();\n        });\n        this.list_marker_around = [];\n      }\n      const { around_places, around_place_center } = this.props;\n      if (around_places.length > 0) {\n        this.list_marker_around = [];\n        let el = document.createElement(\"div\");\n        el.innerHTML = ReactDOMServer.renderToStaticMarkup(\n          <Marker id=\"marker-center\" type=\"center\" />\n        );\n        this.list_marker_around[0] = new maplibregl.Marker(el, {\n          anchor: \"bottom\",\n        })\n          .setPopup(\n            new maplibregl.Popup({\n              offset: [0, -32],\n              className: \"tooltip-marker\",\n              closeButton: false,\n            })\n              .setHTML(\n                `<div class=\"ant-tooltip-inner tooltip-info-location\">${around_place_center.name}</div>`\n              )\n              .setMaxWidth(\"150px\")\n          )\n          .setLngLat(around_place_center.geometry.location)\n          .addTo(this.map);\n        const markerCenterDiv = this.list_marker_around[0].getElement();\n\n        markerCenterDiv.addEventListener(\"click\", () => {\n          this._selectAroundPlace(\"center\", around_place_center);\n          this.props.dispatch(setRedMarkerAction(false));\n          if (this.list_marker_around[0].getPopup().isOpen()) {\n            this.list_marker_around[0].togglePopup();\n          }\n        });\n\n        markerCenterDiv.addEventListener(\"contextmenu\", (e) => {\n          e.stopPropagation();\n          e.preventDefault();\n          this.props.dispatch(setRedMarkerAction(false));\n          this.props.dispatch(\n            setPopupRightClick(\n              true,\n              around_place_center.geometry.location,\n              \"normal\"\n            )\n          );\n        });\n\n        markerCenterDiv.addEventListener(\"mouseenter\", () =>\n          this.list_marker_around[0].togglePopup()\n        );\n        markerCenterDiv.addEventListener(\"mouseleave\", () =>\n          this.list_marker_around[0].togglePopup()\n        );\n\n        around_places.forEach((item, i) => {\n          const popup = new maplibregl.Popup({\n            offset: [0, -32],\n            className: \"tooltip-marker\",\n            closeButton: false,\n            anchor: \"bottom\",\n          })\n            .setHTML(\n              `<div class=\"ant-tooltip-inner tooltip-info-location\">${item.name}</div>`\n            )\n            .setMaxWidth(\"150px\");\n          el = document.createElement(\"div\");\n          el.innerHTML = ReactDOMServer.renderToStaticMarkup(\n            <Marker\n              type=\"around\"\n              place={item}\n              place_select={this.props.around_place_select}\n              id={`marker-around-${i}`}\n            />\n          );\n          this.list_marker_around.push(\n            new maplibregl.Marker(el, { anchor: \"bottom\" })\n              .setPopup(popup)\n              .setLngLat([item.lng_lat[0] * 1, item.lng_lat[1] * 1])\n              .addTo(this.map)\n          );\n          const markerDiv = this.list_marker_around[i + 1].getElement();\n\n          markerDiv.addEventListener(\"click\", (e) => {\n            e.stopPropagation();\n            this.props.dispatch(setRedMarkerAction(false));\n            this._selectAroundPlace(\"around\", item);\n            if (popup.isOpen()) {\n              this.list_marker_around[i + 1].togglePopup();\n            }\n          });\n\n          markerDiv.addEventListener(\"contextmenu\", (e) => {\n            e.stopPropagation();\n            e.preventDefault();\n            this.props.dispatch(\n              setPopupRightClick(\n                true,\n                { lng: item.lng_lat[0] * 1, lat: item.lng_lat[1] * 1 },\n                \"around\"\n              )\n            );\n            this.props.dispatch(setRedMarkerAction(false));\n          });\n\n          markerDiv.addEventListener(\"mouseenter\", () =>\n            this.list_marker_around[i + 1].togglePopup()\n          );\n          markerDiv.addEventListener(\"mouseleave\", () =>\n            this.list_marker_around[i + 1].togglePopup()\n          );\n        });\n      }\n    }\n\n    if (this.props.boxVisible === \"info\" && this.props.current_place) {\n      if (!this.markerCurrentPlace) {\n        const el = document.createElement(\"div\");\n        el.innerHTML = ReactDOMServer.renderToStaticMarkup(\n          // <Marker type=\"normal\" />\n          <div className='marker-histories'>\n            <div>\n              <img src={images.marker} alt=\"\" />\n            </div>\n          </div>\n        );\n        // Marker info\n        this.markerCurrentPlace = new maplibregl.Marker({\n          anchor: \"bottom\", element: el\n        })\n          .setLngLat(this.props.current_place?.geometry?.location)\n          .addTo(this.map);\n        this.markerCurrentPlace\n          .getElement()\n          .addEventListener(\"contextmenu\", (e) => {\n            e.stopPropagation();\n            e.preventDefault();\n            const lngLat = this.markerCurrentPlace.getLngLat();\n            this.props.dispatch(\n              setPopupRightClick(true, lngLat, \"popupCurrentPlace\")\n            );\n          });\n      } else {\n        this.markerCurrentPlace\n          .setLngLat(this.props.current_place.geometry.location)\n          .addTo(this.map);\n      }\n    }\n\n    if (this.props.boxVisible !== \"info\" && this.markerCurrentPlace) {\n      this.markerCurrentPlace.remove();\n      this.markerCurrentPlace = null;\n    }\n    if (this.props.boxVisible === \"detailsrestaurant\" && this.props.restaurantData) {\n      if (this.props.restaurantData.length !== 0) {\n        for (let item of this.props.restaurantData) {\n          const marker_restaurant = document.createElement(\"div\");\n          marker_restaurant.innerHTML = ReactDOMServer.renderToStaticMarkup(\n            // <MarkerNavigation id=\"end-marker\" type=\"histories\" />\n            <div className='marker-histories'>\n              <div>\n                <img src={images.marker} alt=\"\" />\n              </div>\n            </div>\n          );\n          this.restaurant_marker = new maplibregl.Marker({\n            anchor: \"center\",\n            element: marker_restaurant,\n          })\n            // .setPopup(popup)\n            .setLngLat(item.geometry.location)\n            .addTo(this.map);\n          this.listRestaurant.push(this.restaurant_marker)\n        }\n      } else {\n        // console.log('Có')\n        for (let marker of this.listRestaurant) {\n          marker.remove()\n        }\n        this.listRestaurant = []\n      }\n    }\n\n    if (this.props.boxVisible === \"history\") {\n      for (let marker of this.listHistories) {\n        marker.remove()\n      }\n      for (let item of this.props.searchLocalStorage) {\n        const marker_history = document.createElement(\"div\");\n        marker_history.innerHTML = ReactDOMServer.renderToStaticMarkup(\n          <div className='marker-histories'>\n            <div>\n              <img src={images.marker} alt=\"\" />\n            </div>\n          </div>\n        );\n        this.history_marker = new maplibregl.Marker({\n          anchor: \"center\",\n          element: marker_history,\n        })\n          .setLngLat(item.location)\n          .addTo(this.map);\n        this.listHistories.push(this.history_marker)\n      }\n\n    } else {\n      for (let marker of this.listHistories) {\n        marker.remove()\n      }\n    }\n\n\n    // if (this.props.boxVisible === \"details\") {\n    if (this.props.result_navigation && this.props.boxVisible === \"details\") {\n      for (let step of this.props.result_navigation.fastest[0].legs[0].steps) {\n        const popup = new maplibregl.Popup({ offset: [0, -32], className: \"tooltip-marker\", closeButton: false, anchor: 'bottom' })\n          .setHTML(`<div class=\"ant-tooltip-inner tooltip-info-location\">${step.html_instructions}</div>`)\n          .setMaxWidth(\"150px\");\n        const marker_step = document.createElement('div');\n        marker_step.innerHTML = ReactDOMServer.renderToStaticMarkup(<div className='marker-details'></div>);\n        this.step_marker = new maplibregl.Marker({ anchor: 'center', element: marker_step })\n          .setPopup(popup)\n          .setLngLat(step.end_location)\n          .addTo(this.map);\n        this.list.push(this.step_marker)\n      }\n    }\n    else {\n      for (let marker of this.list) {\n        marker.remove()\n      }\n      this.list = []\n    }\n    // }\n    if (this.props.boxVisible === \"navigation\" && isMobile) {\n      if (this.props.result_navigation) {\n        for (let step of this.props.result_navigation.fastest[0].legs[0].steps) {\n          const popup = new maplibregl.Popup({ offset: [0, -32], className: \"tooltip-marker\", closeButton: false, anchor: 'bottom' })\n            .setHTML(`<div class=\"ant-tooltip-inner tooltip-info-location\">${step.html_instructions}</div>`)\n            .setMaxWidth(\"150px\");\n          const marker_step = document.createElement('div');\n          marker_step.innerHTML = ReactDOMServer.renderToStaticMarkup(<div className='marker-details'></div>);\n          this.step_marker = new maplibregl.Marker({ anchor: 'center', element: marker_step })\n            .setPopup(popup)\n            .setLngLat(step.end_location)\n            .addTo(this.map);\n          this.list.push(this.step_marker)\n        }\n      }\n      else {\n        for (let marker of this.list) {\n          marker.remove()\n        }\n        this.list = []\n      }\n    }\n  }\n\n  decodePolyline(encoded) {\n    var points = [];\n    var index = 0,\n      len = encoded.length;\n    var lat = 0,\n      lng = 0;\n\n    while (index < len) {\n      var b,\n        shift = 0,\n        result = 0;\n      do {\n        b = encoded.charAt(index++).charCodeAt(0) - 63;\n        result |= (b & 0x1f) << shift;\n        shift += 5;\n      } while (b >= 0x20);\n      var dlat = result & 1 ? ~(result >> 1) : result >> 1;\n      lat += dlat;\n\n      shift = 0;\n      result = 0;\n      do {\n        b = encoded.charAt(index++).charCodeAt(0) - 63;\n        result |= (b & 0x1f) << shift;\n        shift += 5;\n      } while (b >= 0x20);\n      var dlng = result & 1 ? ~(result >> 1) : result >> 1;\n      lng += dlng;\n\n      points.push([lng * 1e-5, lat * 1e-5]);\n    }\n\n    return points;\n  }\n\n  changeStyle = () => {\n    const { style } = this.state;\n    if (style === STYLE_URL.SATELITE + STYLE_KEY) {\n      this.setState({\n        style: STYLE_URL.NORMAL + STYLE_KEY,\n      });\n      this.map.setStyle(STYLE_URL.NORMAL + STYLE_KEY);\n    } else {\n      this.setState({\n        style: STYLE_URL.SATELITE + STYLE_KEY,\n      });\n      this.map.setStyle(STYLE_URL.SATELITE + STYLE_KEY);\n    }\n  };\n\n  componentDidMount() {\n    window.addEventListener('storage', this.handleStorageChange);\n    // console.log(STYLE_URL.NORMAL)\n    const selectedPlace = this.props.current_place;\n    this.map = new maplibregl.Map({\n      container: \"map\", // container id\n      style: STYLE_URL.NORMAL + STYLE_KEY,\n      center: selectedPlace\n        ? [\n          selectedPlace.geometry.location.lng,\n          selectedPlace.geometry.location.lat,\n        ]\n        : [DEFAULT_VIEWPORT.longitude, DEFAULT_VIEWPORT.latitude], // starting position [lng, lat]\n      zoom: DEFAULT_VIEWPORT.zoom, // starting zoom\n    });\n    if (selectedPlace)\n      this.props.dispatch(\n        setRedMarkerAction(true, selectedPlace.geometry.location)\n      );\n\n    this.navigation = new maplibregl.NavigationControl();\n    this.geolocateControl = new maplibregl.GeolocateControl({\n      positionOptions: {\n        enableHighAccuracy: true,\n      },\n      // Bật tắt hiển bị vị trí\n      trackUserLocation: true,\n      // Hiển thị\n      showUserLocation: true,\n      // Tắt vòng tròn to\n      showAccuracyCircle: false,\n      // Điều chỉnh mức zoom đến vị trí của mình\n      fitBoundsOptions: {\n        maxZoom: 15,\n      },\n    });\n\n    this.geolocateControl.on(\"error\", () => {\n      message.warning(\"Goong không thể lấy địa điểm hiện tại của bạn !\");\n    });\n\n    this.geolocateControl.on(\"geolocate\", (e) => {\n      this.props.dispatch(\n        setMyLocationAction({\n          latitude: e.coords.latitude,\n          longitude: e.coords.longitude,\n        })\n      );\n    });\n\n    !isMobile && this.map.addControl(this.navigation);\n    !isMobile && this.map.addControl(this.geolocateControl);\n\n    this.map.on(\"click\", this._onMouseClick);\n    this.map.on(\"contextmenu\", this._onRightClick);\n    this.map.on(\"load\", () => {\n      this.map.resize();\n\n      const pid = new URLSearchParams(window.location.search).get(\"pid\");\n      const location = new URLSearchParams(window.location.search)\n        .get(\"location\")\n        ?.split(\",\");\n      const pid_around = new URLSearchParams(window.location.search).get(\n        \"pid_around\"\n      );\n      const direction_infor = new URLSearchParams(window.location.search).get(\n        \"direction\"\n      );\n      if (\n        !direction_infor &&\n        !pid &&\n        !location &&\n        !pid_around &&\n        !this.props.current_place\n      )\n        this.geolocateControl?.trigger();\n      else {\n        if (navigator.geolocation) {\n          navigator.geolocation.getCurrentPosition((position) => {\n            this.props.dispatch(\n              setMyLocationAction({\n                latitude: position.coords.latitude,\n                longitude: position.coords.longitude,\n              })\n            );\n          });\n        }\n      }\n    });\n\n    this.map.on(\"move\", () => {\n      this.props.dispatch(\n        setCenterLatLngAction({\n          latitude: this.map.getCenter().lat,\n          longitude: this.map.getCenter().lng,\n        })\n      );\n    });\n    this.map.on(\"style.load\", () => {\n      this.map?.addLayer({\n        id: \"3d-buildings\",\n        source: \"composite\",\n        \"source-layer\": \"VN_Building\",\n        filter: [\"==\", \"extrude\", \"true\"],\n        type: \"fill-extrusion\",\n        minzoom: 15,\n        paint: {\n          \"fill-extrusion-color\": \"#aaa\",\n          \"fill-extrusion-height\": {\n            type: \"identity\",\n            property: \"height\",\n          },\n          \"fill-extrusion-base\": {\n            type: \"identity\",\n            property: \"min_height\",\n          },\n          \"fill-extrusion-opacity\": 0.4,\n        },\n      });\n      if (this.props.result_navigation) {\n        if (this.props.result_select === \"fastest\") {\n          this.props.dispatch(selectResultAction(\"shortest\"));\n          this.props.dispatch(selectResultAction(\"fastest\"));\n        } else {\n          this.props.dispatch(selectResultAction(\"fastest\"));\n          this.props.dispatch(selectResultAction(\"shortest\"));\n        }\n      }\n    });\n    document.body.addEventListener(\"click\", this._onClickMenu);\n    // this.map.on('click', 'route-layer-fastest', (e) => {\n    //   console.log(e, 'fastest');\n    //   e.originalEvent.stopPropagation();\n    //   e.originalEvent.preventDefault();\n    // });\n\n    // this.map.on('click', 'route-layer-shortest', (e) => {\n    //   console.log(e)\n    // });\n\n    const direction_infor = new URLSearchParams(window.location.search).get(\n      \"direction\"\n    );\n    const iframe = new URLSearchParams(window.location.search).get(\n      \"iframe\"\n    );\n    if (direction_infor) {\n      const coor_from = {\n        lat: direction_infor.split(\"&\")[0].split(\",\")[0],\n        lng: direction_infor.split(\"&\")[0].split(\",\")[1],\n      };\n      const coor_to = {\n        lat: direction_infor.split(\"&\")[1].split(\",\")[0],\n        lng: direction_infor.split(\"&\")[1].split(\",\")[1],\n      };\n      if (coor_from.lat && coor_from.lng && coor_to.lat && coor_to.lng) {\n        // this.handleFromHere(coor_from.lat, coor_from.lng);\n        // this.handleToHere(coor_to.lat, coor_to.lng);\n        if (iframe != null) {\n          this.navigationByURLIframe(coor_from, coor_to)\n        } else {\n          this.navigationByURL(coor_from, coor_to)\n        }\n      }\n    }\n  }\n\n  navigationByURLIframe = async (from, to) => {\n    this.props.dispatch(setBoxVisibleAction('iframe'));\n\n    this.props.dispatch(setRedMarkerAction(false));\n    this.changeVisibleBottomInfo(false);\n    let fromplace;\n    if (!from.lat || !from.lng) fromplace = await this._getInforPlace();\n    else {\n      fromplace = await this._getInforPlace(from.lat, from.lng);\n    }\n    await this.props.dispatch(\n      navigationFromAction(\n        fromplace,\n        `${fromplace.name} - ${fromplace.formatted_address}`\n      )\n    );\n    let toplace;\n    if (!to.lat || !to.lng) toplace = await this._getInforPlace();\n    else {\n      toplace = await this._getInforPlace(to.lat, to.lng);\n    }\n    await this.props.dispatch(\n      navigationToAction(\n        toplace,\n        `${toplace.name} - ${toplace.formatted_address}`\n      )\n    );\n    this.props.dispatch(\n      navigationAction(this.props.from_place, this.props.to_place, 'car')\n    );\n  }\n\n  navigationByURL = async (from, to) => {\n    this.props.dispatch(setBoxVisibleAction(\"navigation\"));\n    this.props.dispatch(setRedMarkerAction(false));\n    this.changeVisibleBottomInfo(false);\n    let fromplace;\n    if (!from.lat || !from.lng) fromplace = await this._getInforPlace();\n    else {\n      fromplace = await this._getInforPlace(from.lat, from.lng);\n    }\n    await this.props.dispatch(\n      navigationFromAction(\n        fromplace,\n        `${fromplace.name} - ${fromplace.formatted_address}`\n      )\n    );\n    let toplace;\n    if (!to.lat || !to.lng) toplace = await this._getInforPlace();\n    else {\n      toplace = await this._getInforPlace(to.lat, to.lng);\n    }\n    await this.props.dispatch(\n      navigationToAction(\n        toplace,\n        `${toplace.name} - ${toplace.formatted_address}`\n      )\n    );\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('storage', this.handleStorageChange);\n    document.body.removeEventListener(\"click\", this._onClickMenu);\n  }\n\n  handleStorageChange = (event) => {\n    console.log('oppaopaopa')\n    if (event.key === 'search_history') {\n      this.setState({ value: event.newValue });\n    }\n  };\n\n  render() {\n    const { style, bottomInfoVisible, placeMouseClick } = this.state;\n\n    return (\n      <React.Fragment>\n        <Div100vh>\n          <div id=\"map\"></div>\n          <div>\n            {!isMobile && (\n              <Avatar\n                shape=\"square\"\n                size={64}\n                onClick={this.changeStyle}\n                className=\"change-status-button\"\n                style={{\n                  backgroundImage:\n                    style === STYLE_URL.NORMAL + STYLE_KEY\n                      ? `url(${satellite_img})`\n                      : `url(${normal_map_img})`,\n                }}\n              />\n            )}\n            {isMobile && (\n              <Avatar\n                shape=\"square\"\n                size={64}\n                onClick={this.changeStyle}\n                className=\"change-status-button\"\n                // id='change-status-button--mobile'\n                style={{\n                  backgroundImage:\n                    style === STYLE_URL.NORMAL + STYLE_KEY\n                      ? `url(${satellite_img})`\n                      : `url(${normal_map_img})`,\n                }}\n              />\n            )}\n          </div>\n          {bottomInfoVisible && (\n            <BottomInfoLocation\n              changeVisibleBottomInfo={this.changeVisibleBottomInfo}\n              lat={\n                placeMouseClick.geometry?.location.lat ||\n                Number(placeMouseClick.lng_lat[1])\n              }\n              lng={\n                placeMouseClick.geometry?.location.lng ||\n                Number(placeMouseClick.lng_lat[0])\n              }\n              name={\n                placeMouseClick.name ||\n                placeMouseClick.address_components[0].long_name\n              }\n              isMarkerAround={placeMouseClick.marker_type_id}\n              place_id={placeMouseClick._id}\n              address={\n                this.getAddressGeocode(placeMouseClick) ||\n                placeMouseClick.formatted_address ||\n                placeMouseClick.description.address\n              }\n              removeMarker={this.removeMarkerWhatIs}\n            />\n          )}\n        </Div100vh>\n      </React.Fragment>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    current_place: state.placeReducer.current_place,\n    from_place: state.navigationReducer.from,\n    to_place: state.navigationReducer.to,\n    boxVisible: state.boxVisibleReducer.box_visible,\n    result_navigation: state.navigationReducer.result,\n    viewport: state.placeReducer.viewport,\n    result_select: state.navigationReducer.result_select,\n    around_places: state.searchReducer.around_places,\n    markerSelect: state.boxVisibleReducer.red_marker_visible,\n    positionMarkerSelect: state.boxVisibleReducer.position_red_marker,\n    around_place_center: state.searchReducer.around_place_center,\n    popup_visible: state.boxVisibleReducer.popup_visible,\n    position_popup: state.boxVisibleReducer.position_popup,\n    type_popup: state.boxVisibleReducer.type_popup,\n    around_place_select: state.searchReducer.around_place_select,\n    my_location: state.placeReducer.my_location,\n    restaurantData: state.searchReducer.restaurant_data,\n    searchLocalStorage: state.searchReducer.search_local_storage,\n  };\n};\nexport default connect(mapStateToProps)(Map);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}